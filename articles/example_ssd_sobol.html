<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example for a Sick-Sicker-Dead model, Quasi-Random Sobol Sequence vs. Purely Random • WARDEN</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example for a Sick-Sicker-Dead model, Quasi-Random Sobol Sequence vs. Purely Random">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZEDNGW5QRP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZEDNGW5QRP');
</script><!-- Google tag (gtag.js) -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WARDEN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="View Index"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Basic Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/warden_explained.html">Warden Explained</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd.html">Sick-Sicker-Dead Model (SSD)</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_constrained.html">Resource Constrained Sick-Sicker-Dead model</a></li>
    <li><a class="dropdown-item" href="../articles/inputs_selector.html">How to Use the Automatic Input Selector</a></li>
    <li><a class="dropdown-item" href="../articles/example_eBC.html">Early Breast Cancer</a></li>
    <li><a class="dropdown-item" href="../articles/example_ipd.html">Using Individual Patient Data</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other Tutorials and Tips</h6></li>
    <li><a class="dropdown-item" href="../articles/example_markov.html">Cohort Markov Model</a></li>
    <li><a class="dropdown-item" href="../articles/example_avoiding_cycles.html">How to Avoid Using Cycles to Speed Up Model</a></li>
    <li><a class="dropdown-item" href="../articles/example_uncertainty.html">Structural and Parametric Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_stream.html">Random Number Streams &amp; Luck Adjustment (SSD model)</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_sobol.html">Quasi-Random Sobol Sequence vs. Purely Random (SSD model)</a></li>
    <li><a class="dropdown-item" href="../articles/example_colon_degeling.html">Degeling (2025) using WARDEN instead of simmer</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jsanchezalv/WARDEN" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Example for a Sick-Sicker-Dead model, Quasi-Random Sobol Sequence vs. Purely Random</h1>
                        <h4 data-toc-skip class="author">Javier Sanchez
Alvarez</h4>
            
            <h4 data-toc-skip class="date">October 07, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jsanchezalv/WARDEN/blob/main/vignettes/articles/example_ssd_sobol.Rmd" class="external-link"><code>vignettes/articles/example_ssd_sobol.Rmd</code></a></small>
      <div class="d-none name"><code>example_ssd_sobol.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="main-options">Main options<a class="anchor" aria-label="anchor" href="#main-options"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jsanchezalv.github.io/WARDEN/">WARDEN</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kableExtra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     group_rows</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/rmetrics/" class="external-link">randtoolbox</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"randtoolbox"</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/rmetrics/" class="external-link">randtoolbox</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Loading required package: randtoolbox</span></span>
<span><span class="co">#&gt; Loading required package: rngWELL</span></span>
<span><span class="co">#&gt; This is randtoolbox. For an overview, type 'help("randtoolbox")'.</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tibble.print_max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document runs a discrete event simulation model in the context
of a late oncology model to show how using quasi-random numbers can
radically change convergence speed by using quasi-random sobol sequences
instead of purely random numbers.</p>
<p>Sobol sequences are a deterministic way of generating numbers
(between 0 and 1) in a way that fills the space very evenly. Several
methods can be used to randomize the generation of these sequences, and
to create multiple dimensions when we want to have multiple variables
using these sequences. Sobol sequences can fill out the space more
evenly than a random uniform distribution, so they can make a model
converge faster.</p>
<p>This vignette explores how one can use sobol sequences to accelerate
convergence and reduce the number of profiles needed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">n_points</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span></span>
<span><span class="va">sobol_seq</span> <span class="op">&lt;-</span> <span class="fu">randtoolbox</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtoolbox/man/quasiRNG.html" class="external-link">sobol</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_points</span>, dim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">random_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_points</span> <span class="op">*</span> <span class="fl">2</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sobol_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sobol_seq</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">sobol_seq</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, Type <span class="op">=</span> <span class="st">"Sobol"</span><span class="op">)</span></span>
<span><span class="va">random_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">random_points</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">random_points</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, Type <span class="op">=</span> <span class="st">"Random Uniform"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">combined_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">sobol_df</span>, <span class="va">random_df</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">combined_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, color <span class="op">=</span> <span class="va">Type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Type</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comparison of Sobol Sequence vs Random Uniform Sampling"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_ssd_sobol_files/figure-html/sobol_vs_random-1.png" width="700"></p>
<p>When running a DES, it’s important to consider speed. Simulation
based models can be computationally expensive, which means that using
efficient coding can have a substantial impact on performance.</p>
</div>
<div class="section level2">
<h2 id="general-inputs-with-delayed-execution">General inputs with delayed execution<a class="anchor" aria-label="anchor" href="#general-inputs-with-delayed-execution"></a>
</h2>
<p>When we generate inputs, we create two versions, one with random
numbers generated from a uniform variable, and another generated from a
sobol sequence.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">randtoolbox</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtoolbox/man/quasiRNG.html" class="external-link">sobol</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>, init <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#initialize</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]  0.5  0.5</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">common_all_inputs</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span></span>
<span>                      util.sick <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                      util.sicker <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                      cost.sick <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>                      cost.sicker <span class="op">=</span> <span class="fl">7000</span>,</span>
<span>                      cost.int <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                      coef_noint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,</span>
<span>                      HR_int <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                      drc <span class="op">=</span> <span class="fl">0.035</span>, </span>
<span>                      drq <span class="op">=</span> <span class="fl">0.035</span></span>
<span>                      <span class="op">)</span></span>
<span></span>
<span><span class="va">common_all_inputs_unif</span> <span class="op">&lt;-</span> <span class="va">common_all_inputs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>random_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,</span>
<span>           random_n_death <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="co">#we draw N random uniform samples</span></span>
<span></span>
<span><span class="va">common_all_inputs_sobol</span> <span class="op">&lt;-</span> <span class="va">common_all_inputs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>random_sobol <span class="op">=</span> <span class="op">(</span><span class="fu">randtoolbox</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtoolbox/man/quasiRNG.html" class="external-link">sobol</a></span><span class="op">(</span><span class="va">N</span>,<span class="fl">2</span>, init <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">N</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">N</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">1</span>,</span>
<span>           random_n <span class="op">=</span> <span class="va">random_sobol</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>           random_n_death <span class="op">=</span> <span class="va">random_sobol</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>  <span class="co">#we draw n sobol sequences, we need to do a small trick as scrambling and seeds are temporarely deactivated within the randtoolbox package</span></span>
<span></span>
<span><span class="va">common_pt_inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>death<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0.0000001</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">random_n_death</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, mean<span class="op">=</span><span class="fl">12</span>, sd<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co">#use random number for death to draw from a normal distribution</span></span>
<span></span>
<span><span class="va">unique_pt_inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>fl.sick <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             q_default <span class="op">=</span> <span class="va">util.sick</span>,</span>
<span>                             c_default <span class="op">=</span> <span class="va">cost.sick</span> <span class="op">+</span> <span class="kw">if</span><span class="op">(</span><span class="va">arm</span><span class="op">==</span><span class="st">"int"</span><span class="op">)</span><span class="op">{</span><span class="va">cost.int</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="fl">0</span><span class="op">}</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="events">Events<a class="anchor" aria-label="anchor" href="#events"></a>
</h2>
<div class="section level3">
<h3 id="add-initial-events">Add Initial Events<a class="anchor" aria-label="anchor" href="#add-initial-events"></a>
</h3>
<p>Time to event for the exponential is drawn using the random
number</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">init_event_list</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/add_tte.html">add_tte</a></span><span class="op">(</span>arm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"noint"</span>,<span class="st">"int"</span><span class="op">)</span>, evts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sick"</span>,<span class="st">"sicker"</span>,<span class="st">"death"</span><span class="op">)</span> ,input<span class="op">=</span><span class="op">{</span></span>
<span>    <span class="va">sick</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">sicker</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">qexp</a></span><span class="op">(</span><span class="va">random_n</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">coef_noint</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">arm</span><span class="op">==</span><span class="st">"int"</span>,<span class="va">HR_int</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#draw the TTE using the random number we created</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-reaction-to-those-events">Add Reaction to Those Events<a class="anchor" aria-label="anchor" href="#add-reaction-to-those-events"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">evt_react_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/add_reactevt.html">add_reactevt</a></span><span class="op">(</span>name_evt <span class="op">=</span> <span class="st">"sick"</span>,</span>
<span>               input <span class="op">=</span> <span class="op">{</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_reactevt.html">add_reactevt</a></span><span class="op">(</span>name_evt <span class="op">=</span> <span class="st">"sicker"</span>,</span>
<span>               input <span class="op">=</span> <span class="op">{</span></span>
<span>                 <span class="va">q_default</span> <span class="op">&lt;-</span> <span class="va">util.sicker</span></span>
<span>                 <span class="va">c_default</span> <span class="op">&lt;-</span> <span class="va">cost.sicker</span> <span class="op">+</span> <span class="kw">if</span><span class="op">(</span><span class="va">arm</span><span class="op">==</span><span class="st">"int"</span><span class="op">)</span><span class="op">{</span><span class="va">cost.int</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="fl">0</span><span class="op">}</span></span>
<span>                 <span class="va">fl.sick</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>               <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_reactevt.html">add_reactevt</a></span><span class="op">(</span>name_evt <span class="op">=</span> <span class="st">"death"</span>,</span>
<span>               input <span class="op">=</span> <span class="op">{</span></span>
<span>                 <span class="va">q_default</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>                 <span class="va">c_default</span> <span class="op">&lt;-</span> <span class="fl">0</span> </span>
<span>                 <span class="va">curtime</span> <span class="op">&lt;-</span> <span class="cn">Inf</span> </span>
<span>               <span class="op">}</span><span class="op">)</span> </span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="costs-and-utilities">Costs and Utilities<a class="anchor" aria-label="anchor" href="#costs-and-utilities"></a>
</h2>
<div class="section level3">
<h3 id="utilities">Utilities<a class="anchor" aria-label="anchor" href="#utilities"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">util_ongoing</span> <span class="op">&lt;-</span> <span class="st">"q_default"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="costs">Costs<a class="anchor" aria-label="anchor" href="#costs"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cost_ongoing</span> <span class="op">&lt;-</span> <span class="st">"c_default"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<div class="section level3">
<h3 id="model-execution">Model Execution<a class="anchor" aria-label="anchor" href="#model-execution"></a>
</h3>
<p>We run both versions of the model for a few simulations to showcase
the different speed of convergence.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="va">N</span>,                               </span>
<span>  n_sim<span class="op">=</span><span class="va">sims</span>,                                  </span>
<span>  psa_bool <span class="op">=</span> <span class="cn">FALSE</span>,                         </span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>,             </span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs_unif</span>,    </span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,       </span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,       </span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        </span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          </span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  ipd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Patient-arm data aggregated across events by selecting the last value for input_out items.</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.38s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.53s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.34s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.34s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.33s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 1.92s</span></span>
<span><span class="co">#&gt; Total time to run: 1.92s</span></span>
<span><span class="co">#&gt; Simulation finalized;</span></span>
<span></span>
<span><span class="va">results_sobol</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="va">N</span>,                               </span>
<span>  n_sim<span class="op">=</span><span class="va">sims</span>,                                  </span>
<span>  psa_bool <span class="op">=</span> <span class="cn">FALSE</span>,                         </span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>,             </span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs_sobol</span>,    </span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,       </span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,       </span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        </span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          </span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  ipd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Patient-arm data aggregated across events by selecting the last value for input_out items.</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.35s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.37s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.35s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.35s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.36s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 1.79s</span></span>
<span><span class="co">#&gt; Total time to run: 1.79s</span></span>
<span><span class="co">#&gt; Simulation finalized;</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="post-processing-of-model-outputs">Post-processing of Model Outputs<a class="anchor" aria-label="anchor" href="#post-processing-of-model-outputs"></a>
</h2>
<div class="section level3">
<h3 id="summary-of-results">Summary of Results<a class="anchor" aria-label="anchor" href="#summary-of-results"></a>
</h3>
<p>Once the models have been run, we merge the data and generate the
cumulative ICER to see how fast they converge to the final estimated
value.</p>
<p>It can clearly be seen that the random uniform approach makes the
model converge much more slowly than the sobol sequences.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/summary_results_sim.html">summary_results_sim</a></span><span class="op">(</span><span class="va">results_unif</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="co">#&gt;                                       int                                noint</span></span>
<span><span class="co">#&gt; costs             59,311 (57,721; 61,331)              52,090 (50,691; 53,841)</span></span>
<span><span class="co">#&gt; dcosts                           0 (0; 0)                 7,220 (7,030; 7,490)</span></span>
<span><span class="co">#&gt; lys                     9.73 (9.59; 9.92)                    9.73 (9.59; 9.92)</span></span>
<span><span class="co">#&gt; dlys                             0 (0; 0)                             0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys                   6.26 (6.19; 6.41)                       6.07 (6; 6.21)</span></span>
<span><span class="co">#&gt; dqalys                           0 (0; 0)                 0.188 (0.177; 0.198)</span></span>
<span><span class="co">#&gt; ICER                         NaN (NA; NA) Inf (4,098,046,449,958,334,464; Inf)</span></span>
<span><span class="co">#&gt; ICUR                         NaN (NA; NA)              38,402 (36,636; 42,307)</span></span>
<span><span class="co">#&gt; INMB                         NaN (NA; NA)                 2,201 (1,362; 2,608)</span></span>
<span><span class="co">#&gt; costs_undisc      74,738 (72,292; 77,497)              65,881 (63,744; 68,262)</span></span>
<span><span class="co">#&gt; dcosts_undisc                    0 (0; 0)                 8,857 (8,548; 9,234)</span></span>
<span><span class="co">#&gt; lys_undisc                12 (11.8; 12.3)                      12 (11.8; 12.3)</span></span>
<span><span class="co">#&gt; dlys_undisc                      0 (0; 0)                             0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys_undisc             7.6 (7.49; 7.82)                    7.37 (7.25; 7.57)</span></span>
<span><span class="co">#&gt; dqalys_undisc                    0 (0; 0)                  0.236 (0.222; 0.25)</span></span>
<span><span class="co">#&gt; ICER_undisc                  NaN (NA; NA)                       Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; ICUR_undisc                  NaN (NA; NA)              37,578 (35,334; 41,552)</span></span>
<span><span class="co">#&gt; INMB_undisc                  NaN (NA; NA)                 2,956 (1,878; 3,550)</span></span>
<span><span class="co">#&gt; c_default         59,311 (57,721; 61,331)              52,090 (50,691; 53,841)</span></span>
<span><span class="co">#&gt; dc_default                       0 (0; 0)                 7,220 (7,030; 7,490)</span></span>
<span><span class="co">#&gt; c_default_undisc  74,738 (72,292; 77,497)              65,881 (63,744; 68,262)</span></span>
<span><span class="co">#&gt; dc_default_undisc                0 (0; 0)                 8,857 (8,548; 9,234)</span></span>
<span><span class="co">#&gt; q_default               6.26 (6.19; 6.41)                       6.07 (6; 6.21)</span></span>
<span><span class="co">#&gt; dq_default                       0 (0; 0)                 0.188 (0.177; 0.198)</span></span>
<span><span class="co">#&gt; q_default_undisc         7.6 (7.49; 7.82)                    7.37 (7.25; 7.57)</span></span>
<span><span class="co">#&gt; dq_default_undisc                0 (0; 0)                  0.236 (0.222; 0.25)</span></span>
<span><span class="fu"><a href="../reference/summary_results_sim.html">summary_results_sim</a></span><span class="op">(</span><span class="va">results_sobol</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="co">#&gt;                                       int                   noint</span></span>
<span><span class="co">#&gt; costs             59,690 (59,520; 59,864) 52,398 (52,230; 52,544)</span></span>
<span><span class="co">#&gt; dcosts                           0 (0; 0)    7,292 (7,254; 7,320)</span></span>
<span><span class="co">#&gt; lys                     9.74 (9.72; 9.78)       9.74 (9.72; 9.78)</span></span>
<span><span class="co">#&gt; dlys                             0 (0; 0)                0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys                   6.24 (6.22; 6.26)       6.06 (6.04; 6.08)</span></span>
<span><span class="co">#&gt; dqalys                           0 (0; 0)    0.184 (0.183; 0.185)</span></span>
<span><span class="co">#&gt; ICER                         NaN (NA; NA)          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; ICUR                         NaN (NA; NA) 39,650 (39,172; 39,973)</span></span>
<span><span class="co">#&gt; INMB                         NaN (NA; NA)    1,904 (1,833; 2,005)</span></span>
<span><span class="co">#&gt; costs_undisc      75,219 (74,954; 75,482) 66,248 (65,985; 66,470)</span></span>
<span><span class="co">#&gt; dcosts_undisc                    0 (0; 0)    8,971 (8,915; 9,012)</span></span>
<span><span class="co">#&gt; lys_undisc                  12 (12; 12.1)           12 (12; 12.1)</span></span>
<span><span class="co">#&gt; dlys_undisc                      0 (0; 0)                0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys_undisc            7.58 (7.56; 7.62)       7.36 (7.33; 7.39)</span></span>
<span><span class="co">#&gt; dqalys_undisc                    0 (0; 0)    0.229 (0.227; 0.231)</span></span>
<span><span class="co">#&gt; ICER_undisc                  NaN (NA; NA)          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; ICUR_undisc                  NaN (NA; NA) 39,184 (38,637; 39,531)</span></span>
<span><span class="co">#&gt; INMB_undisc                  NaN (NA; NA)    2,477 (2,381; 2,622)</span></span>
<span><span class="co">#&gt; c_default         59,690 (59,520; 59,864) 52,398 (52,230; 52,544)</span></span>
<span><span class="co">#&gt; dc_default                       0 (0; 0)    7,292 (7,254; 7,320)</span></span>
<span><span class="co">#&gt; c_default_undisc  75,219 (74,954; 75,482) 66,248 (65,985; 66,470)</span></span>
<span><span class="co">#&gt; dc_default_undisc                0 (0; 0)    8,971 (8,915; 9,012)</span></span>
<span><span class="co">#&gt; q_default               6.24 (6.22; 6.26)       6.06 (6.04; 6.08)</span></span>
<span><span class="co">#&gt; dq_default                       0 (0; 0)    0.184 (0.183; 0.185)</span></span>
<span><span class="co">#&gt; q_default_undisc        7.58 (7.56; 7.62)       7.36 (7.33; 7.39)</span></span>
<span><span class="co">#&gt; dq_default_undisc                0 (0; 0)    0.229 (0.227; 0.231)</span></span>
<span></span>
<span></span>
<span><span class="va">det_ipd_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">results_unif</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"unif"</span><span class="op">)</span></span>
<span><span class="va">det_ipd_sobol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">results_sobol</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"sobol"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merged_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">det_ipd_unif</span>,<span class="va">det_ipd_sobol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">arm</span>, <span class="va">type</span>, <span class="va">simulation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cumul_total_qalys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">total_qalys</span><span class="op">)</span><span class="op">/</span><span class="va">pat_id</span>,</span>
<span>         cumul_total_costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">total_costs</span><span class="op">)</span><span class="op">/</span><span class="va">pat_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">pat_id</span>, <span class="va">arm</span>, <span class="va">simulation</span>, <span class="va">cumul_total_qalys</span>, <span class="va">cumul_total_costs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">arm</span>, values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cumul_total_qalys</span>,<span class="va">cumul_total_costs</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>inc_costs <span class="op">=</span> <span class="va">cumul_total_costs_int</span> <span class="op">-</span> <span class="va">cumul_total_costs_noint</span>,</span>
<span>         inc_qalys <span class="op">=</span> <span class="va">cumul_total_qalys_int</span> <span class="op">-</span> <span class="va">cumul_total_qalys_noint</span>,</span>
<span>         ICER <span class="op">=</span> <span class="va">inc_costs</span><span class="op">/</span> <span class="va">inc_qalys</span><span class="op">)</span> </span>
<span>  </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">merged_ipd</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">pat_id</span>,y<span class="op">=</span><span class="va">ICER</span>, colour <span class="op">=</span> <span class="va">type</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">30000</span>,<span class="fl">45000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 49 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="example_ssd_sobol_files/figure-html/post-processing_summary-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="model-with-psa">Model with PSA<a class="anchor" aria-label="anchor" href="#model-with-psa"></a>
</h2>
<div class="section level3">
<h3 id="model-execution-1">Model Execution<a class="anchor" aria-label="anchor" href="#model-execution-1"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load some data</span></span>
<span><span class="va">list_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parameter_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"util.sick"</span>,<span class="st">"util.sicker"</span>,<span class="st">"cost.sick"</span>,<span class="st">"cost.sicker"</span>,<span class="st">"cost.int"</span>,<span class="st">"coef_noint"</span>,<span class="st">"HR_int"</span><span class="op">)</span>,</span>
<span>                              base_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">3000</span>,<span class="fl">7000</span>,<span class="fl">1000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,<span class="fl">0.8</span><span class="op">)</span>,</span>
<span>                              DSA_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">1000</span>,<span class="fl">5000</span>,<span class="fl">800</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                              DSA_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">0.7</span>,<span class="fl">5000</span>,<span class="fl">9000</span>,<span class="fl">2000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.4</span><span class="op">)</span>,<span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                              PSA_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"qnorm"</span>,<span class="st">"qbeta_mse"</span>,<span class="st">"qgamma_mse"</span>,<span class="st">"qgamma_mse"</span>,<span class="st">"qgamma_mse"</span>,<span class="st">"qnorm"</span>,<span class="st">"qlnorm"</span><span class="op">)</span>,</span>
<span>                              a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">3000</span>,<span class="fl">7000</span>,<span class="fl">1000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">3000</span>,<span class="fl">7000</span>,<span class="fl">1000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              scenario_1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">1000</span>,<span class="fl">5000</span>,<span class="fl">800</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                              scenario_2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">0.7</span>,<span class="fl">5000</span>,<span class="fl">9000</span>,<span class="fl">2000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.4</span><span class="op">)</span>,<span class="fl">0.9</span><span class="op">)</span></span>
<span>                              <span class="op">)</span></span>
<span></span>
<span><span class="va">sensitivity_inputs</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span></span>
<span>            indicators <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">sensitivity_bool</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="../reference/create_indicators.html">create_indicators</a></span><span class="op">(</span><span class="va">sens</span>,<span class="va">n_sensitivity</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sensitivity_names</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="co">#vector of indicators, value 0 everywhere except at sens, where it takes value 1 (for dsa_min and dsa_max, if not sensitivity analysis, then we activate all of them, i.e., in a PSA)</span></span>
<span>                              <span class="op">)</span></span>
<span></span>
<span><span class="va">common_all_inputs</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span></span>
<span>  random_sobol_psa <span class="op">=</span> <span class="op">(</span><span class="fu">randtoolbox</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtoolbox/man/quasiRNG.html" class="external-link">sobol</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span>, init <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">7</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="../reference/pick_val_v.html">pick_val_v</a></span><span class="op">(</span>base        <span class="op">=</span> <span class="va">list_par</span><span class="op">[[</span><span class="st">"base_value"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       psa         <span class="op">=</span> <span class="fu"><a href="../reference/pick_psa.html">pick_psa</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="st">"PSA_dist"</span><span class="op">]</span><span class="op">]</span>,<span class="va">random_sobol_psa</span>,<span class="va">list_par</span><span class="op">[[</span><span class="st">"a"</span><span class="op">]</span><span class="op">]</span>,<span class="va">list_par</span><span class="op">[[</span><span class="st">"b"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                       sens        <span class="op">=</span> <span class="va">list_par</span><span class="op">[[</span><span class="va">sens_name_used</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       psa_ind     <span class="op">=</span> <span class="va">psa_bool</span>,</span>
<span>                       sens_ind    <span class="op">=</span> <span class="va">sensitivity_bool</span>,</span>
<span>                       indicator   <span class="op">=</span> <span class="va">indicators</span>,</span>
<span>                       names_out   <span class="op">=</span> <span class="va">list_par</span><span class="op">[[</span><span class="st">"parameter_name"</span><span class="op">]</span><span class="op">]</span></span>
<span>                       <span class="op">)</span></span>
<span>            <span class="op">)</span> </span>
<span></span>
<span><span class="va">common_all_inputs_unif</span> <span class="op">&lt;-</span> <span class="va">common_all_inputs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>random_n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span>,</span>
<span>           random_n_death <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">N</span><span class="op">)</span><span class="op">)</span> <span class="co">#we draw N random uniform samples</span></span>
<span></span>
<span><span class="va">common_all_inputs_sobol</span> <span class="op">&lt;-</span> <span class="va">common_all_inputs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>random_sobol <span class="op">=</span> <span class="op">(</span><span class="fu">randtoolbox</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/randtoolbox/man/quasiRNG.html" class="external-link">sobol</a></span><span class="op">(</span><span class="va">N</span>,<span class="fl">2</span>, init <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">N</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">N</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%%</a></span> <span class="fl">1</span>,</span>
<span>           random_n <span class="op">=</span> <span class="va">random_sobol</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>           random_n_death <span class="op">=</span> <span class="va">random_sobol</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>  <span class="co">#we draw n sobol sequences, we need to do a small trick as scrambling and seeds are temporarely deactivated within the randtoolbox package</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">results_unif_psa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="va">N</span>,                               </span>
<span>  n_sim<span class="op">=</span><span class="va">sims</span>,                                  </span>
<span>  psa_bool <span class="op">=</span> <span class="cn">TRUE</span>,                         </span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>,</span>
<span>  sensitivity_inputs <span class="op">=</span> <span class="va">sensitivity_inputs</span>,</span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs_unif</span>,    </span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,       </span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,       </span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        </span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          </span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  ipd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Patient-arm data aggregated across events by selecting the last value for input_out items.</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.35s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.33s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.57s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.32s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.34s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 1.91s</span></span>
<span><span class="co">#&gt; Total time to run: 1.91s</span></span>
<span><span class="co">#&gt; Simulation finalized;</span></span>
<span></span>
<span><span class="va">results_sobol_psa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="va">N</span>,                               </span>
<span>  n_sim<span class="op">=</span><span class="va">sims</span>,                                  </span>
<span>  psa_bool <span class="op">=</span> <span class="cn">TRUE</span>,                         </span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>, </span>
<span>  sensitivity_inputs <span class="op">=</span> <span class="va">sensitivity_inputs</span>,</span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs_sobol</span>,    </span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,       </span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,       </span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        </span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          </span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  ipd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Patient-arm data aggregated across events by selecting the last value for input_out items.</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.33s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.34s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.34s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.35s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.53s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 1.9s</span></span>
<span><span class="co">#&gt; Total time to run: 1.9s</span></span>
<span><span class="co">#&gt; Simulation finalized;</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="post-processing-of-psa-outputs">Post-processing of PSA Outputs<a class="anchor" aria-label="anchor" href="#post-processing-of-psa-outputs"></a>
</h2>
<div class="section level3">
<h3 id="summary-of-results-1">Summary of Results<a class="anchor" aria-label="anchor" href="#summary-of-results-1"></a>
</h3>
<p>Once the models have been run, we merge the data and generate the
cumulative ICER to see how fast they converge to the final estimated
value.</p>
<p>It can clearly be seen that the random uniform approach makes the
model converge much more slowly than the sobol sequences.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/summary_results_sim.html">summary_results_sim</a></span><span class="op">(</span><span class="va">results_unif_psa</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="co">#&gt;                                       int                                 noint</span></span>
<span><span class="co">#&gt; costs             60,135 (58,358; 63,200)               53,027 (51,433; 55,367)</span></span>
<span><span class="co">#&gt; dcosts                           0 (0; 0)                  7,108 (5,895; 7,833)</span></span>
<span><span class="co">#&gt; lys                       10 (9.85; 10.2)                       10 (9.85; 10.2)</span></span>
<span><span class="co">#&gt; dlys                             0 (0; 0)                              0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys                   6.33 (5.57; 6.79)                     6.12 (5.47; 6.54)</span></span>
<span><span class="co">#&gt; dqalys                           0 (0; 0)                    0.21 (0.093; 0.25)</span></span>
<span><span class="co">#&gt; ICER                         NaN (NA; NA) Inf (-4,409,497,606,028,984,320; Inf)</span></span>
<span><span class="co">#&gt; ICUR                         NaN (NA; NA)               38,930 (24,034; 74,072)</span></span>
<span><span class="co">#&gt; INMB                         NaN (NA; NA)                 3,388 (-2,237; 6,369)</span></span>
<span><span class="co">#&gt; costs_undisc      73,464 (71,670; 76,813)               64,968 (62,912; 67,508)</span></span>
<span><span class="co">#&gt; dcosts_undisc                    0 (0; 0)                  8,495 (7,051; 9,305)</span></span>
<span><span class="co">#&gt; lys_undisc                12 (11.8; 12.3)                       12 (11.8; 12.3)</span></span>
<span><span class="co">#&gt; dlys_undisc                      0 (0; 0)                              0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys_undisc            7.48 (6.62; 7.99)                     7.22 (6.51; 7.69)</span></span>
<span><span class="co">#&gt; dqalys_undisc                    0 (0; 0)                  0.254 (0.112; 0.302)</span></span>
<span><span class="co">#&gt; ICER_undisc                  NaN (NA; NA) Inf (-5,238,257,628,334,784,512; Inf)</span></span>
<span><span class="co">#&gt; ICUR_undisc                  NaN (NA; NA)               38,554 (23,613; 73,550)</span></span>
<span><span class="co">#&gt; INMB_undisc                  NaN (NA; NA)                 4,183 (-2,637; 7,879)</span></span>
<span><span class="co">#&gt; c_default         60,135 (58,358; 63,200)               53,027 (51,433; 55,367)</span></span>
<span><span class="co">#&gt; dc_default                       0 (0; 0)                  7,108 (5,895; 7,833)</span></span>
<span><span class="co">#&gt; c_default_undisc  73,464 (71,670; 76,813)               64,968 (62,912; 67,508)</span></span>
<span><span class="co">#&gt; dc_default_undisc                0 (0; 0)                  8,495 (7,051; 9,305)</span></span>
<span><span class="co">#&gt; q_default               6.33 (5.57; 6.79)                     6.12 (5.47; 6.54)</span></span>
<span><span class="co">#&gt; dq_default                       0 (0; 0)                    0.21 (0.093; 0.25)</span></span>
<span><span class="co">#&gt; q_default_undisc        7.48 (6.62; 7.99)                     7.22 (6.51; 7.69)</span></span>
<span><span class="co">#&gt; dq_default_undisc                0 (0; 0)                  0.254 (0.112; 0.302)</span></span>
<span><span class="fu"><a href="../reference/summary_results_sim.html">summary_results_sim</a></span><span class="op">(</span><span class="va">results_sobol_psa</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> </span>
<span><span class="co">#&gt;                                       int                   noint</span></span>
<span><span class="co">#&gt; costs             60,571 (57,975; 65,556) 53,370 (52,029; 57,428)</span></span>
<span><span class="co">#&gt; dcosts                           0 (0; 0)    7,200 (5,946; 8,128)</span></span>
<span><span class="co">#&gt; lys                       10 (9.99; 10.1)         10 (9.99; 10.1)</span></span>
<span><span class="co">#&gt; dlys                             0 (0; 0)                0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys                   6.31 (5.59; 6.83)         6.1 (5.5; 6.59)</span></span>
<span><span class="co">#&gt; dqalys                           0 (0; 0)    0.203 (0.092; 0.242)</span></span>
<span><span class="co">#&gt; ICER                         NaN (NA; NA)          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; ICUR                         NaN (NA; NA) 40,231 (26,299; 75,677)</span></span>
<span><span class="co">#&gt; INMB                         NaN (NA; NA)   2,970 (-2,366; 5,358)</span></span>
<span><span class="co">#&gt; costs_undisc      73,994 (70,836; 80,126) 65,368 (63,721; 70,376)</span></span>
<span><span class="co">#&gt; dcosts_undisc                    0 (0; 0)    8,626 (7,115; 9,750)</span></span>
<span><span class="co">#&gt; lys_undisc                  12 (12; 12.1)           12 (12; 12.1)</span></span>
<span><span class="co">#&gt; dlys_undisc                      0 (0; 0)                0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys_undisc            7.45 (6.66; 8.07)       7.21 (6.55; 7.78)</span></span>
<span><span class="co">#&gt; dqalys_undisc                    0 (0; 0)    0.244 (0.111; 0.289)</span></span>
<span><span class="co">#&gt; ICER_undisc                  NaN (NA; NA)          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; ICUR_undisc                  NaN (NA; NA) 40,091 (26,173; 75,312)</span></span>
<span><span class="co">#&gt; INMB_undisc                  NaN (NA; NA)   3,590 (-2,809; 6,477)</span></span>
<span><span class="co">#&gt; c_default         60,571 (57,975; 65,556) 53,370 (52,029; 57,428)</span></span>
<span><span class="co">#&gt; dc_default                       0 (0; 0)    7,200 (5,946; 8,128)</span></span>
<span><span class="co">#&gt; c_default_undisc  73,994 (70,836; 80,126) 65,368 (63,721; 70,376)</span></span>
<span><span class="co">#&gt; dc_default_undisc                0 (0; 0)    8,626 (7,115; 9,750)</span></span>
<span><span class="co">#&gt; q_default               6.31 (5.59; 6.83)         6.1 (5.5; 6.59)</span></span>
<span><span class="co">#&gt; dq_default                       0 (0; 0)    0.203 (0.092; 0.242)</span></span>
<span><span class="co">#&gt; q_default_undisc        7.45 (6.66; 8.07)       7.21 (6.55; 7.78)</span></span>
<span><span class="co">#&gt; dq_default_undisc                0 (0; 0)    0.244 (0.111; 0.289)</span></span>
<span></span>
<span></span>
<span><span class="va">psa_ipd_unif</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">results_unif_psa</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"unif"</span><span class="op">)</span></span>
<span><span class="va">psa_ipd_sobol</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">results_sobol_psa</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"sobol"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">merged_ipd_psa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">psa_ipd_unif</span>,<span class="va">psa_ipd_sobol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">arm</span>, <span class="va">type</span>, <span class="va">simulation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cumul_total_qalys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">total_qalys</span><span class="op">)</span><span class="op">/</span><span class="va">pat_id</span>,</span>
<span>         cumul_total_costs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">total_costs</span><span class="op">)</span><span class="op">/</span><span class="va">pat_id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span><span class="va">type</span>, <span class="va">pat_id</span>, <span class="va">arm</span>, <span class="va">simulation</span>, <span class="va">cumul_total_qalys</span>, <span class="va">cumul_total_costs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">arm</span>, values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cumul_total_qalys</span>,<span class="va">cumul_total_costs</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>inc_costs <span class="op">=</span> <span class="va">cumul_total_costs_int</span> <span class="op">-</span> <span class="va">cumul_total_costs_noint</span>,</span>
<span>         inc_qalys <span class="op">=</span> <span class="va">cumul_total_qalys_int</span> <span class="op">-</span> <span class="va">cumul_total_qalys_noint</span>,</span>
<span>         ICER <span class="op">=</span> <span class="va">inc_costs</span><span class="op">/</span> <span class="va">inc_qalys</span><span class="op">)</span> </span>
<span>  </span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">merged_ipd_psa</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">pat_id</span>,y<span class="op">=</span><span class="va">ICER</span>, colour <span class="op">=</span> <span class="va">type</span>, fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">20000</span>,<span class="fl">80000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 7 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre></div>
<p><img src="example_ssd_sobol_files/figure-html/post-processing_summary_psa-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Javier Sanchez Alvarez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
