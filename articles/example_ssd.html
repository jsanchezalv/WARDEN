<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Example for a Sick-Sicker-Dead model • WARDEN</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example for a Sick-Sicker-Dead model">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WARDEN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html" aria-label="View Index"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/warden_explained.html">Warden Explained</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd.html">Example in a Sick-Sicker-Dead Model</a></li>
    <li><a class="dropdown-item" href="../articles/inputs_selector.html">How to Use the Automatic Input Selector</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_stream.html">Example in a Sick-Sicker-Dead Model - Random Number Streams &amp; Luck Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_sobol.html">Example in a Sick-Sicker-Dead Model - Quasi-Random Sobol Sequence vs. Purely Random</a></li>
    <li><a class="dropdown-item" href="../articles/example_eBC.html">Example in Early Breast Cancer</a></li>
    <li><a class="dropdown-item" href="../articles/example_markov.html">Example in a Markov Model</a></li>
    <li><a class="dropdown-item" href="../articles/example_uncertainty.html">Structural and Parametric Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/example_ipd.html">Example for Individual Patient Data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jsanchezalv/WARDEN" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="example_ssd_files/kePrint-0.0.1/kePrint.js"></script><link href="example_ssd_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Example for a Sick-Sicker-Dead model</h1>
                        <h4 data-toc-skip class="author">Javier Sanchez
Alvarez and Valerie Aponte Ribero</h4>
            
            <h4 data-toc-skip class="date">May 29, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jsanchezalv/WARDEN/blob/main/vignettes/example_ssd.Rmd" class="external-link"><code>vignettes/example_ssd.Rmd</code></a></small>
      <div class="d-none name"><code>example_ssd.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document runs a discrete event simulation model in the context
of a late oncology model to show how the functions can be used to
generate a model in only a few steps.</p>
<p>When running a DES, it’s important to consider speed. Simulation
based models can be computationally expensive, which means that using
efficient coding can have a substantial impact on performance.</p>
<div class="section level3">
<h3 id="main-options">Main options<a class="anchor" aria-label="anchor" href="#main-options"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://jsanchezalv.github.io/WARDEN/">WARDEN</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'kableExtra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dplyr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     group_rows</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>tibble.print_max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="general-inputs-with-delayed-execution">General inputs with delayed execution<a class="anchor" aria-label="anchor" href="#general-inputs-with-delayed-execution"></a>
</h2>
<p>Initial inputs and flags that will be used in the model can be
defined below. We can define inputs that will only change across
scenarios (<code>sensitivity_inputs</code>), inputs which are common to
all patients (<code>common_all_inputs</code>) within a simulation,
inputs that are unique to a patient independently of the treatment
(e.g. natural time to death, defined in <code>common_pt_inputs</code>),
and inputs that are unique to that patient and that treatment
(<code>unique_pt_inputs</code>). Items can be included through both the
<code>add_item</code> or <code>add_item2</code> functions, and can be
used in subsequent items. All these inputs are generated before the
events and the reaction to events are executed. Furthermore, the program
first executes <code>common_all_inputs</code>, then
<code>common_pt_inputs</code> and then <code>unique_pt_inputs</code>. So
one could use the items generated in <code>common_all_inputs</code> in
<code>unique_pt_inputs</code>. Note that inputs are “reset” after each
patient, so if patient 1 arm “noint” changes <code>util.sick</code> to
be = 2, even if it’s a common parameter for everyone, it would be reset
to 1 for patient 1 arm “int”.</p>
<p>Note that time to death is set in the common_pt_inputs, but it could
also just be set in the <code>add_tte</code> function explained below.
The user has full flexibility on how to implement this type of
inputs.</p>
<p>There are some auxiliary functions to help setting up inputs, like
<code>pick_val_v</code> and <code>pick_val</code> (and
<code>pick_psa</code>, see below the section on <a href="#sensitivity-analysis">Sensitivity Analysis</a>). Note that
<code>pick_val_v</code> and <code>pick_val</code> can be directly loaded
as parameters (in fact, a named list will be loaded directly by R). A
small tweak is needed if it’s the first item added, in which the item
list must be initiated by using <code><a href="../reference/add_item.html">add_item()</a></code> (see below).
Alternatively, if using <code><a href="../reference/add_item2.html">add_item2()</a></code>, this is not needed,
and <code>pick_val_v</code> just needs to be used with an additional
argument <code>deploy_env = TRUE</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#We don't need to use sensitivity_inputs here, so we don't add that object</span></span>
<span></span>
<span><span class="co">#Put objects here that do not change on any patient or intervention loop</span></span>
<span><span class="co">#We use add_item2 and add_item to showcase how the user can implement the inputs (either works, add_item2 is just faster)</span></span>
<span><span class="va">common_all_inputs</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/add_item2.html">add_item2</a></span><span class="op">(</span>input <span class="op">=</span> <span class="op">{</span></span>
<span>                      <span class="va">util.sick</span>   <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span>                      <span class="va">util.sicker</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span>                      <span class="va">cost.sick</span>   <span class="op">&lt;-</span> <span class="fl">3000</span></span>
<span>                      <span class="va">cost.sicker</span> <span class="op">&lt;-</span> <span class="fl">7000</span></span>
<span>                      <span class="va">cost.int</span>    <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span>                      <span class="va">coef_noint</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span></span>
<span>                      <span class="va">HR_int</span>      <span class="op">&lt;-</span> <span class="fl">0.8</span></span>
<span>                      <span class="va">drc</span>         <span class="op">&lt;-</span> <span class="fl">0.035</span> <span class="co">#different values than what's assumed by default</span></span>
<span>                      <span class="va">drq</span>         <span class="op">&lt;-</span> <span class="fl">0.035</span></span>
<span>                      <span class="va">random_seed_sicker_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="fl">100000</span>,<span class="va">npats</span>,replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span>  <span class="co">#to be used as seeds to draw the time to event for sicker, to ensure same luck for the same patient independently of the arm</span></span>
<span></span>
<span></span>
<span><span class="co">#Put objects here that do not change as we loop through treatments for a patient</span></span>
<span><span class="va">common_pt_inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>death<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">0.0000001</span>,<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>, mean<span class="op">=</span><span class="fl">12</span>, sd<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co">#Put objects here that change as we loop through treatments for each patient (e.g. events can affect fl.tx, but events do not affect nat.os.s)</span></span>
<span><span class="va">unique_pt_inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>fl.sick <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             q_default <span class="op">=</span> <span class="va">util.sick</span>,</span>
<span>                             c_default <span class="op">=</span> <span class="va">cost.sick</span> <span class="op">+</span> <span class="kw">if</span><span class="op">(</span><span class="va">arm</span><span class="op">==</span><span class="st">"int"</span><span class="op">)</span><span class="op">{</span><span class="va">cost.int</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="fl">0</span><span class="op">}</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level2">
<h2 id="events">Events<a class="anchor" aria-label="anchor" href="#events"></a>
</h2>
<div class="section level3">
<h3 id="add-initial-events">Add Initial Events<a class="anchor" aria-label="anchor" href="#add-initial-events"></a>
</h3>
<p>Events are added below through the <code>add_tte</code> function. We
use this function once applying to both interventions. We must define
several arguments: one to indicate the intervention, one to define the
names of the events used, one to define the names of other objects
created that we would like to store (optional, maybe we generate an
intermediate input which is not an event but that we want to save) and
the actual input in which we generate the time to event. Events and
other objects will be automatically initialized to <code>Inf</code>. We
draw the times to event for the patients. Note: the order of the
<code>evts</code> argument that appears first will be used as a
reference of the order in which to process events in the case of ties
(so “sick” would be processed before “sicker” if there is a tie in time
to event.)</p>
<p>Note that the model will use the evnets defined in <code>evts</code>
argument to look for the objects both defined in the input list and in
this expression to allocate time to events. If an event is declared in
<code>evts</code> but not defined elsewhere, then they would be assumed
TTE of <code>Inf</code> by default.</p>
<p>This chunk is a bit more complex, so it’s worth spending a bit of
time explaining it.</p>
<p>The <code>init_event_list</code> object is populated by using the
<code>add_tte</code> function which applies to both arms, “int” strategy
and “noint” strategy. We first declare the <code>start</code> time to be
<code>0</code>. Note this could also be separated by arm if the user
wants to have more clarity using two <code>add_tte</code> functions
(i.e.,
<code>add_tte(arm="noint"...) %&gt;% add_tte(arm="int"...)</code>).</p>
<p>We then proceed to generate the actual time to event. We use the
<code><a href="../reference/draw_tte.html">draw_tte()</a></code> function to generate the time to event, though
one can set this up in any other way (e.g., using <code>rexp</code>).
One should always be aware of how the competing risks interact with each
other. While we have abstracted from these type of corrections here, it
is recommended to have an understanding about how these affect the
results and have a look at the competing risks/semi-competing risks
literature.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">init_event_list</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/add_tte.html">add_tte</a></span><span class="op">(</span>arm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"noint"</span>,<span class="st">"int"</span><span class="op">)</span>, evts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sick"</span>,<span class="st">"sicker"</span>,<span class="st">"death"</span><span class="op">)</span> ,input<span class="op">=</span><span class="op">{</span></span>
<span>    <span class="va">sick</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">sicker</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draw_tte.html">draw_tte</a></span><span class="op">(</span><span class="fl">1</span>,dist<span class="op">=</span><span class="st">"exp"</span>, coef1<span class="op">=</span><span class="va">coef_noint</span>, beta_tx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">arm</span><span class="op">==</span><span class="st">"int"</span>,<span class="va">HR_int</span>,<span class="fl">1</span><span class="op">)</span>, seed <span class="op">=</span> <span class="va">random_seed_sicker_i</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co">#this way the value would be the same if it wasn't for the HR, effectively "cloning" patients luck</span></span>
<span>    </span>
<span>  <span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-reaction-to-those-events">Add Reaction to Those Events<a class="anchor" aria-label="anchor" href="#add-reaction-to-those-events"></a>
</h3>
<p>Once the initial times of the events have been defined, we also need
to declare how events react and affect each other. To do so, we use the
<code>evt_react_list</code> object and the <code>add_reactevt</code>
function. This function just needs to state which event is affected, and
the actual reaction (usually setting flags to 1 or 0, or creating
new/adjusting events).</p>
<p>There are a series of objects that can be used in this context to
help with the reactions. Apart from the global objects and flags defined
above, we can also use <code>curtime</code> for the current event time,
<code>prevtime</code> for the time of the previous event,
<code>cur_evtlist</code> for the named vector of events that is yet to
happen for that patient, <code>arm</code> for the current treatment in
the loop, <code>evt</code> for the current event being processed,
<code>i</code> expresses the patient iteration, and
<code>simulation</code> the specific simulation (relevant when the
number of simulations is greater than 1). Furthermore, one can also call
any other input/item that has been created before or create new ones.
For example, we could even modify a cost/utility item by changing it
directly, e.g. through <code>modify_item(list(cost.idfs.tx=500))</code>
or assigning it directly <code>cost.idfs.tx &lt;- 500</code>.</p>
<table class="table">
<colgroup>
<col width="48%">
<col width="52%">
</colgroup>
<thead><tr class="header">
<th>Item</th>
<th>What does it do</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>curtime</code></td>
<td>Current event time (numeric)</td>
</tr>
<tr class="even">
<td><code>prevtime</code></td>
<td>Time of the previous event (numeric)</td>
</tr>
<tr class="odd">
<td><code>cur_evtlist</code></td>
<td>Named vector of events that is yet to happen for that patient (named
numeric vector)</td>
</tr>
<tr class="even">
<td><code>evt</code></td>
<td>Current event being processed (character)</td>
</tr>
<tr class="odd">
<td><code>i</code></td>
<td>Patient being iterated (numeric)</td>
</tr>
<tr class="even">
<td><code>arm</code></td>
<td>Intervention being iterated (character)</td>
</tr>
<tr class="odd">
<td><code>simulation</code></td>
<td>Simulation being iterated (numeric)</td>
</tr>
<tr class="even">
<td><code>sens</code></td>
<td>Sensitivity analysis being iterated (numeric)</td>
</tr>
</tbody>
</table>
<p>The functions to add/modify events and inputs use lists. Whenever
several inputs/events are added or modified, it’s recommended to group
them within one function, as it reduces the computation cost. So rather
than use two <code>modify_event</code> with a list of one element, it’s
better to group them into a single <code>modify_event</code> with a list
of two elements.</p>
<p><code>new_event</code>allows to generate events and add them to the
vector of events. It accepts more than one event.
<code>modify_event</code> allows to modify events (e.g. delay death).
When adding an event, the name of the events and the time of the events
must be defined. When using <code>modify_event</code>, one must indicate
which events are affected and what are the new times of the events. If
the event specified does not exist or has already occurred, it will be
ignored. <code>modify_event</code> with
<code>create_if_null = TRUE</code> argument will also generate events if
they don’t exist. Note that one could potentially omit part of the
modeling set in <code>init_event_list</code> and actually define new
events dynamically through the reactions (we do that below for the
<code>"ae"</code> event). However, this can have an impact in
computation time, so if possible it’s always better to use
<code>init_event_list</code>.</p>
<p>To modify/create items, WARDEN now allows to assign them directly in
the code, without the need to use <code>modify_item</code> and
<code>modify_item_seq</code>, which allows the code to run faster
(~30-35% faster if comparing against <code>modify_item_seq</code>, or
15-20% if comparing against <code>modify_item</code>). However, these
two functions, <code>modify_item</code> and
<code>modify_item_seq</code>, are still available to the user and will
keep working, and allow to modify and add items. Elements defined within
this function are not evaluated sequentially in <code>modify_item</code>
(i.e. defining
<code>modify_item(list(fl.new = 1, var1 = fl.new * 5)))</code> will give
an error if <code>fl.new</code> was not defined outside this function),
while <code>modify_item_seq</code> will do it sequentially at a slightly
bigger computational cost, so both are left as choices for the user.
Note that one can modify costs/utilities by using the construction
<code>type_name_category</code>, where type is either “qaly” or “cost”,
name is the name (e.g., “default”) and category is the category used
(e.g., “instant”), so one could pass <code>cost_default_instant</code>
and modify the cost.</p>
<p>The list of relevant functions to be used within
<code>add_reactevt</code> are:</p>
<table class="table">
<colgroup>
<col width="31%">
<col width="34%">
<col width="34%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>What does it do</th>
<th>How to use it</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="../reference/modify_item.html">modify_item()</a></code></td>
<td>Adds &amp; Modifies items/flags/variables for future events</td>
<td><code>modify_item(list("fl.idfs.ontx"=0,"fl.tx.beva"=0))</code></td>
</tr>
<tr class="even">
<td><code><a href="../reference/modify_item_seq.html">modify_item_seq()</a></code></td>
<td>Adds &amp; Modifies items/flags/variables for future events
sequentially</td>
<td><code>modify_item_seq(list("fl.idfs.ontx"=0,"fl.tx.beva"=0))</code></td>
</tr>
<tr class="odd">
<td><code><a href="../reference/new_event.html">new_event()</a></code></td>
<td>Adds events to the vector of events for that patient</td>
<td><code>new_event(rep(list("ae"=curtime + 0.001),5))</code></td>
</tr>
<tr class="even">
<td><code><a href="../reference/modify_event.html">modify_event()</a></code></td>
<td>Modifies (or creates, with <code>create_if_null = TRUE</code>)
existing events by changing their time</td>
<td><code>modify_event(list("os"=curtime +5, "ttot"=curtime+0.0001))</code></td>
</tr>
</tbody>
</table>
<p>The model will run until <code>curtime</code> is set to
<code>Inf</code>, so the event that terminates the model (in this case,
<code>os</code>), should modify <code>curtime</code> and set it to
<code>Inf</code>.</p>
<p>Finally, note that there could be two different ways of accumulating
continuous outcomes, backwards (i.e., in the example below, we would set
q_default = util.sick at the sicker event, and modify the
<code>q_default</code> value in the death event) and forwards (as in the
example below). This option can be modified in the <code>run_sim</code>
function using the <code>accum_backwards</code> argument, which assumes
forwards by default.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">evt_react_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/add_reactevt.html">add_reactevt</a></span><span class="op">(</span>name_evt <span class="op">=</span> <span class="st">"sick"</span>,</span>
<span>               input <span class="op">=</span> <span class="op">{</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_reactevt.html">add_reactevt</a></span><span class="op">(</span>name_evt <span class="op">=</span> <span class="st">"sicker"</span>,</span>
<span>               input <span class="op">=</span> <span class="op">{</span></span>
<span>                 <span class="va">q_default</span> <span class="op">&lt;-</span> <span class="va">util.sicker</span></span>
<span>                 <span class="va">c_default</span> <span class="op">&lt;-</span> <span class="va">cost.sicker</span> <span class="op">+</span> <span class="kw">if</span><span class="op">(</span><span class="va">arm</span><span class="op">==</span><span class="st">"int"</span><span class="op">)</span><span class="op">{</span><span class="va">cost.int</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span><span class="fl">0</span><span class="op">}</span></span>
<span>                 <span class="va">fl.sick</span>   <span class="op">&lt;-</span> <span class="fl">0</span> </span>
<span>               <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_reactevt.html">add_reactevt</a></span><span class="op">(</span>name_evt <span class="op">=</span> <span class="st">"death"</span>,</span>
<span>               input <span class="op">=</span> <span class="op">{</span></span>
<span>                 <span class="va">q_default</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>                 <span class="va">c_default</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>                 <span class="va">curtime</span>   <span class="op">&lt;-</span> <span class="cn">Inf</span></span>
<span>               <span class="op">}</span><span class="op">)</span> </span>
<span></span>
<span></span>
<span><span class="co"># Below how it would be set up if using `accum_backwards = TRUE` in `run_sim()` (and will give equal final results)</span></span>
<span><span class="co"># Note that we set the value applied in the reaction right up to the event, changing the interpretation of the reaction</span></span>
<span><span class="co"># It is also a slower method than the standard approach</span></span>
<span><span class="co"># In this case we use `modify_item_seq` in the reaction for death, but given that the items are not interacting with each other,</span></span>
<span><span class="co"># we could use `modify_item` instead and make the computation faster</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># evt_react_list &lt;-</span></span>
<span><span class="co">#     add_reactevt(name_evt = "sick",</span></span>
<span><span class="co">#                  input = {}) %&gt;%</span></span>
<span><span class="co">#     add_reactevt(name_evt = "sicker",</span></span>
<span><span class="co">#                  input = {</span></span>
<span><span class="co">#                      modify_item(list(</span></span>
<span><span class="co">#                      q_default = util.sick,</span></span>
<span><span class="co">#                      c_default = cost.sick + if(arm=="int"){cost.int}else{0},</span></span>
<span><span class="co">#                      fl.sick = 0</span></span>
<span><span class="co">#                      ))</span></span>
<span><span class="co">#                  }) %&gt;%</span></span>
<span><span class="co">#     add_reactevt(name_evt = "death",</span></span>
<span><span class="co">#                  input = {</span></span>
<span><span class="co">#                      c_dis &lt;- if(fl.sick==1){cost.sick}else{cost.sicker} </span></span>
<span><span class="co">#                      modify_item_seq(list(</span></span>
<span><span class="co">#                      q_default = if(fl.sick==1){util.sick}else{util.sicker},</span></span>
<span><span class="co">#                      c_default = c_dis + if(arm=="int"){cost.int}else{0},</span></span>
<span><span class="co">#                      curtime = Inf</span></span>
<span><span class="co">#                      ))</span></span>
<span><span class="co">#                  }) </span></span></code></pre></div>
<div class="section level4">
<h4 id="extract-interactions-within-events">Extract Interactions Within Events<a class="anchor" aria-label="anchor" href="#extract-interactions-within-events"></a>
</h4>
<p>As an additional optional step, to easily see the interactions
between the reactions of the events, we can also now use the
<code>extract_from_reactions</code> function to obtain a data.frame with
all the relationships defined in the reactions in the model. This
functions looks at all assignments (through <code>&lt;-</code> or
<code>=</code> or <code>assign</code>), <code>modify_item</code>,
<code>modify_item_seq</code>, <code>modify_event</code> and
<code>new_event</code> and checks which elements are being defined
there, their definition, and whether they are triggered conditionally
(e.g., <code>"if(a==1){modify_item(list(b=2))}"</code>). Note it would
be straightforward to build a network graph showcasing all the
interactions between events in terms of events affecting other events,
or to show which (and how) events affect specific items.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_interactions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_from_reactions.html">extract_from_reactions</a></span><span class="op">(</span><span class="va">evt_react_list</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">df_interactions</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="7%">
<col width="10%">
<col width="5%">
<col width="18%">
<col width="57%">
</colgroup>
<thead><tr class="header">
<th align="left">event</th>
<th align="left">name</th>
<th align="left">type</th>
<th align="left">conditional_flag</th>
<th align="left">definition</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">sicker</td>
<td align="left">q_default</td>
<td align="left">item</td>
<td align="left">FALSE</td>
<td align="left">util.sicker</td>
</tr>
<tr class="even">
<td align="left">sicker</td>
<td align="left">c_default</td>
<td align="left">item</td>
<td align="left">FALSE</td>
<td align="left">cost.sicker + if (arm == ‘int’) {cost.int} else
{0}</td>
</tr>
<tr class="odd">
<td align="left">sicker</td>
<td align="left">fl.sick</td>
<td align="left">item</td>
<td align="left">FALSE</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">death</td>
<td align="left">q_default</td>
<td align="left">item</td>
<td align="left">FALSE</td>
<td align="left">0</td>
</tr>
<tr class="odd">
<td align="left">death</td>
<td align="left">c_default</td>
<td align="left">item</td>
<td align="left">FALSE</td>
<td align="left">0</td>
</tr>
<tr class="even">
<td align="left">death</td>
<td align="left">curtime</td>
<td align="left">item</td>
<td align="left">FALSE</td>
<td align="left">Inf</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="costs-and-utilities">Costs and Utilities<a class="anchor" aria-label="anchor" href="#costs-and-utilities"></a>
</h2>
<p>Costs and utilities are introduced below. However, it’s worth noting
that the model is able to run without costs or utilities.</p>
<p>Utilities/Costs/Other outputs are defined by declaring which object
belongs to utilities/costs/other outputs, and whether they need to be
discounted continuously or discretely (instantaneous). These will be
passed to the <code>run_sim</code> function.</p>
<div class="section level3">
<h3 id="utilities">Utilities<a class="anchor" aria-label="anchor" href="#utilities"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">util_ongoing</span> <span class="op">&lt;-</span> <span class="st">"q_default"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="costs">Costs<a class="anchor" aria-label="anchor" href="#costs"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cost_ongoing</span> <span class="op">&lt;-</span> <span class="st">"c_default"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<div class="section level3">
<h3 id="model-execution">Model Execution<a class="anchor" aria-label="anchor" href="#model-execution"></a>
</h3>
<p>The model can be run using the function <code>run_sim</code> below.
We must define the number of patients to be simulated, the number of
simulations, whether we want to run a PSA or not, the strategy list, the
inputs, events and reactions defined above, utilities, costs and also if
we want any extra output and the level of ipd data desired to be
exported.</p>
<p>It is worth noting that the <code>psa_bool</code> argument does not
run a PSA automatically, but is rather an additional input/flag of the
model that we use as a reference to determine whether we want to use a
deterministic or stochastic input. As such, it could also be defined in
<code>common_all_inputs</code> as the first item to be defined, and the
result would be the same. However, we recommend it to be defined in
<code>run_sim</code>.</p>
<p>Note that the distribution chosen, the number of events and the
interaction between events can have a substantial impact on the running
time of the model.</p>
<p>Debugging can be implemented using the argument <code>debug</code> in
the <code>run_sim</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Logic is: per patient, per intervention, per event, react to that event.</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="fl">1000</span>,                               <span class="co"># number of patients to be simulated</span></span>
<span>  n_sim<span class="op">=</span><span class="fl">1</span>,                                  <span class="co"># number of simulations to run</span></span>
<span>  psa_bool <span class="op">=</span> <span class="cn">FALSE</span>,                         <span class="co"># use PSA or not. If n_sim &gt; 1 and psa_bool = FALSE, then difference in outcomes is due to sampling (number of pats simulated)  </span></span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>,             <span class="co"># intervention list</span></span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs</span>,    <span class="co"># inputs common that do not change within a simulation</span></span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,      <span class="co"># inputs that change within a simulation but are not affected by the intervention</span></span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,      <span class="co"># inputs that change within a simulation between interventions</span></span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        <span class="co"># initial event list</span></span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          <span class="co"># reaction of events</span></span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  ipd <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.78s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 0.78s</span></span>
<span><span class="co">#&gt; Total time to run: 0.78s</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="post-processing-of-model-outputs">Post-processing of Model Outputs<a class="anchor" aria-label="anchor" href="#post-processing-of-model-outputs"></a>
</h2>
<div class="section level3">
<h3 id="summary-of-results">Summary of Results<a class="anchor" aria-label="anchor" href="#summary-of-results"></a>
</h3>
<p>Once the model has been run, we can use the results and summarize
them using the <code>summary_results_det</code> to print the results of
the last simulation (if <code>nsim = 1</code>, it’s the deterministic
case), and <code>summary_results_sim</code> to show the PSA results
(with the confidence intervals). We can also use the individual patient
data generated by the simulation, which we collect here to plot in the
<code>psa_ipd</code> object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="fu"><a href="../reference/summary_results_det.html">summary_results_det</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#print first simulation</span></span>
<span><span class="co">#&gt;                        int    noint</span></span>
<span><span class="co">#&gt; costs             58978.88 51768.23</span></span>
<span><span class="co">#&gt; dcosts                0.00  7210.66</span></span>
<span><span class="co">#&gt; lys                   9.72     9.72</span></span>
<span><span class="co">#&gt; dlys                  0.00     0.00</span></span>
<span><span class="co">#&gt; qalys                 6.27     6.08</span></span>
<span><span class="co">#&gt; dqalys                0.00     0.19</span></span>
<span><span class="co">#&gt; ICER                    NA      Inf</span></span>
<span><span class="co">#&gt; ICUR                    NA 38286.46</span></span>
<span><span class="co">#&gt; INMB                    NA  2206.06</span></span>
<span><span class="co">#&gt; costs_undisc      74324.03 65474.81</span></span>
<span><span class="co">#&gt; dcosts_undisc         0.00  8849.22</span></span>
<span><span class="co">#&gt; lys_undisc           11.99    11.99</span></span>
<span><span class="co">#&gt; dlys_undisc           0.00     0.00</span></span>
<span><span class="co">#&gt; qalys_undisc          7.62     7.38</span></span>
<span><span class="co">#&gt; dqalys_undisc         0.00     0.24</span></span>
<span><span class="co">#&gt; ICER_undisc             NA      Inf</span></span>
<span><span class="co">#&gt; ICUR_undisc             NA 37557.56</span></span>
<span><span class="co">#&gt; INMB_undisc             NA  2931.65</span></span>
<span><span class="co">#&gt; c_default         58978.88 51768.23</span></span>
<span><span class="co">#&gt; dc_default            0.00  7210.66</span></span>
<span><span class="co">#&gt; c_default_undisc  74324.03 65474.81</span></span>
<span><span class="co">#&gt; dc_default_undisc     0.00  8849.22</span></span>
<span><span class="co">#&gt; q_default             6.27     6.08</span></span>
<span><span class="co">#&gt; dq_default            0.00     0.19</span></span>
<span><span class="co">#&gt; q_default_undisc      7.62     7.38</span></span>
<span><span class="co">#&gt; dq_default_undisc     0.00     0.24</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summary_results_sim.html">summary_results_sim</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                       int                   noint</span></span>
<span><span class="co">#&gt; costs             58,979 (58,979; 58,979) 51,768 (51,768; 51,768)</span></span>
<span><span class="co">#&gt; dcosts                           0 (0; 0)    7,211 (7,211; 7,211)</span></span>
<span><span class="co">#&gt; lys                     9.72 (9.72; 9.72)       9.72 (9.72; 9.72)</span></span>
<span><span class="co">#&gt; dlys                             0 (0; 0)                0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys                   6.27 (6.27; 6.27)       6.08 (6.08; 6.08)</span></span>
<span><span class="co">#&gt; dqalys                           0 (0; 0)    0.188 (0.188; 0.188)</span></span>
<span><span class="co">#&gt; ICER                         NaN (NA; NA)          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; ICUR                         NaN (NA; NA) 38,286 (38,286; 38,286)</span></span>
<span><span class="co">#&gt; INMB                         NaN (NA; NA)    2,206 (2,206; 2,206)</span></span>
<span><span class="co">#&gt; costs_undisc      74,324 (74,324; 74,324) 65,475 (65,475; 65,475)</span></span>
<span><span class="co">#&gt; dcosts_undisc                    0 (0; 0)    8,849 (8,849; 8,849)</span></span>
<span><span class="co">#&gt; lys_undisc                    12 (12; 12)             12 (12; 12)</span></span>
<span><span class="co">#&gt; dlys_undisc                      0 (0; 0)                0 (0; 0)</span></span>
<span><span class="co">#&gt; qalys_undisc            7.62 (7.62; 7.62)       7.38 (7.38; 7.38)</span></span>
<span><span class="co">#&gt; dqalys_undisc                    0 (0; 0)    0.236 (0.236; 0.236)</span></span>
<span><span class="co">#&gt; ICER_undisc                  NaN (NA; NA)          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; ICUR_undisc                  NaN (NA; NA) 37,558 (37,558; 37,558)</span></span>
<span><span class="co">#&gt; INMB_undisc                  NaN (NA; NA)    2,932 (2,932; 2,932)</span></span>
<span><span class="co">#&gt; c_default         58,979 (58,979; 58,979) 51,768 (51,768; 51,768)</span></span>
<span><span class="co">#&gt; dc_default                       0 (0; 0)    7,211 (7,211; 7,211)</span></span>
<span><span class="co">#&gt; c_default_undisc  74,324 (74,324; 74,324) 65,475 (65,475; 65,475)</span></span>
<span><span class="co">#&gt; dc_default_undisc                0 (0; 0)    8,849 (8,849; 8,849)</span></span>
<span><span class="co">#&gt; q_default               6.27 (6.27; 6.27)       6.08 (6.08; 6.08)</span></span>
<span><span class="co">#&gt; dq_default                       0 (0; 0)    0.188 (0.188; 0.188)</span></span>
<span><span class="co">#&gt; q_default_undisc        7.62 (7.62; 7.62)       7.38 (7.38; 7.38)</span></span>
<span><span class="co">#&gt; dq_default_undisc                0 (0; 0)    0.236 (0.236; 0.236)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summary_results_sens.html">summary_results_sens</a></span><span class="op">(</span><span class="va">results</span><span class="op">)</span></span>
<span><span class="co">#&gt;        arm analysis analysis_name          variable                   value</span></span>
<span><span class="co">#&gt;     &lt;char&gt;    &lt;int&gt;        &lt;char&gt;            &lt;fctr&gt;                  &lt;char&gt;</span></span>
<span><span class="co">#&gt;  1:    int        1                           costs 58,979 (58,979; 58,979)</span></span>
<span><span class="co">#&gt;  2:  noint        1                           costs 51,768 (51,768; 51,768)</span></span>
<span><span class="co">#&gt;  3:    int        1                          dcosts                0 (0; 0)</span></span>
<span><span class="co">#&gt;  4:  noint        1                          dcosts    7,211 (7,211; 7,211)</span></span>
<span><span class="co">#&gt;  5:    int        1                             lys       9.72 (9.72; 9.72)</span></span>
<span><span class="co">#&gt;  6:  noint        1                             lys       9.72 (9.72; 9.72)</span></span>
<span><span class="co">#&gt;  7:    int        1                            dlys                0 (0; 0)</span></span>
<span><span class="co">#&gt;  8:  noint        1                            dlys                0 (0; 0)</span></span>
<span><span class="co">#&gt;  9:    int        1                           qalys       6.27 (6.27; 6.27)</span></span>
<span><span class="co">#&gt; 10:  noint        1                           qalys       6.08 (6.08; 6.08)</span></span>
<span><span class="co">#&gt; 11:    int        1                          dqalys                0 (0; 0)</span></span>
<span><span class="co">#&gt; 12:  noint        1                          dqalys    0.188 (0.188; 0.188)</span></span>
<span><span class="co">#&gt; 13:    int        1                            ICER            NaN (NA; NA)</span></span>
<span><span class="co">#&gt; 14:  noint        1                            ICER          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; 15:    int        1                            ICUR            NaN (NA; NA)</span></span>
<span><span class="co">#&gt; 16:  noint        1                            ICUR 38,286 (38,286; 38,286)</span></span>
<span><span class="co">#&gt; 17:    int        1                            INMB            NaN (NA; NA)</span></span>
<span><span class="co">#&gt; 18:  noint        1                            INMB    2,206 (2,206; 2,206)</span></span>
<span><span class="co">#&gt; 19:    int        1                    costs_undisc 74,324 (74,324; 74,324)</span></span>
<span><span class="co">#&gt; 20:  noint        1                    costs_undisc 65,475 (65,475; 65,475)</span></span>
<span><span class="co">#&gt; 21:    int        1                   dcosts_undisc                0 (0; 0)</span></span>
<span><span class="co">#&gt; 22:  noint        1                   dcosts_undisc    8,849 (8,849; 8,849)</span></span>
<span><span class="co">#&gt; 23:    int        1                      lys_undisc             12 (12; 12)</span></span>
<span><span class="co">#&gt; 24:  noint        1                      lys_undisc             12 (12; 12)</span></span>
<span><span class="co">#&gt; 25:    int        1                     dlys_undisc                0 (0; 0)</span></span>
<span><span class="co">#&gt; 26:  noint        1                     dlys_undisc                0 (0; 0)</span></span>
<span><span class="co">#&gt; 27:    int        1                    qalys_undisc       7.62 (7.62; 7.62)</span></span>
<span><span class="co">#&gt; 28:  noint        1                    qalys_undisc       7.38 (7.38; 7.38)</span></span>
<span><span class="co">#&gt; 29:    int        1                   dqalys_undisc                0 (0; 0)</span></span>
<span><span class="co">#&gt; 30:  noint        1                   dqalys_undisc    0.236 (0.236; 0.236)</span></span>
<span><span class="co">#&gt; 31:    int        1                     ICER_undisc            NaN (NA; NA)</span></span>
<span><span class="co">#&gt; 32:  noint        1                     ICER_undisc          Inf (Inf; Inf)</span></span>
<span><span class="co">#&gt; 33:    int        1                     ICUR_undisc            NaN (NA; NA)</span></span>
<span><span class="co">#&gt; 34:  noint        1                     ICUR_undisc 37,558 (37,558; 37,558)</span></span>
<span><span class="co">#&gt; 35:    int        1                     INMB_undisc            NaN (NA; NA)</span></span>
<span><span class="co">#&gt; 36:  noint        1                     INMB_undisc    2,932 (2,932; 2,932)</span></span>
<span><span class="co">#&gt; 37:    int        1                       c_default 58,979 (58,979; 58,979)</span></span>
<span><span class="co">#&gt; 38:  noint        1                       c_default 51,768 (51,768; 51,768)</span></span>
<span><span class="co">#&gt; 39:    int        1                      dc_default                0 (0; 0)</span></span>
<span><span class="co">#&gt; 40:  noint        1                      dc_default    7,211 (7,211; 7,211)</span></span>
<span><span class="co">#&gt; 41:    int        1                c_default_undisc 74,324 (74,324; 74,324)</span></span>
<span><span class="co">#&gt; 42:  noint        1                c_default_undisc 65,475 (65,475; 65,475)</span></span>
<span><span class="co">#&gt; 43:    int        1               dc_default_undisc                0 (0; 0)</span></span>
<span><span class="co">#&gt; 44:  noint        1               dc_default_undisc    8,849 (8,849; 8,849)</span></span>
<span><span class="co">#&gt; 45:    int        1                       q_default       6.27 (6.27; 6.27)</span></span>
<span><span class="co">#&gt; 46:  noint        1                       q_default       6.08 (6.08; 6.08)</span></span>
<span><span class="co">#&gt; 47:    int        1                      dq_default                0 (0; 0)</span></span>
<span><span class="co">#&gt; 48:  noint        1                      dq_default    0.188 (0.188; 0.188)</span></span>
<span><span class="co">#&gt; 49:    int        1                q_default_undisc       7.62 (7.62; 7.62)</span></span>
<span><span class="co">#&gt; 50:  noint        1                q_default_undisc       7.38 (7.38; 7.38)</span></span>
<span><span class="co">#&gt; 51:    int        1               dq_default_undisc                0 (0; 0)</span></span>
<span><span class="co">#&gt; 52:  noint        1               dq_default_undisc    0.236 (0.236; 0.236)</span></span>
<span><span class="co">#&gt;        arm analysis analysis_name          variable                   value</span></span>
<span></span>
<span><span class="va">psa_ipd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">psa_ipd</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>, <span class="st">"responsive"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
evtname
</th>
<th style="text-align:right;">
evttime
</th>
<th style="text-align:right;">
prevtime
</th>
<th style="text-align:right;">
pat_id
</th>
<th style="text-align:left;">
arm
</th>
<th style="text-align:right;">
total_lys
</th>
<th style="text-align:right;">
total_qalys
</th>
<th style="text-align:right;">
total_costs
</th>
<th style="text-align:right;">
total_costs_undisc
</th>
<th style="text-align:right;">
total_qalys_undisc
</th>
<th style="text-align:right;">
total_lys_undisc
</th>
<th style="text-align:right;">
lys
</th>
<th style="text-align:right;">
qalys
</th>
<th style="text-align:right;">
costs
</th>
<th style="text-align:right;">
lys_undisc
</th>
<th style="text-align:right;">
qalys_undisc
</th>
<th style="text-align:right;">
costs_undisc
</th>
<th style="text-align:right;">
c_default
</th>
<th style="text-align:right;">
q_default
</th>
<th style="text-align:right;">
c_default_undisc
</th>
<th style="text-align:right;">
q_default_undisc
</th>
<th style="text-align:right;">
nexttime
</th>
<th style="text-align:right;">
simulation
</th>
<th style="text-align:right;">
sensitivity
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
sick
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
10.34
</td>
<td style="text-align:right;">
8.27
</td>
<td style="text-align:right;">
41358
</td>
<td style="text-align:right;">
51112
</td>
<td style="text-align:right;">
10.22
</td>
<td style="text-align:right;">
12.78
</td>
<td style="text-align:right;">
10.339
</td>
<td style="text-align:right;">
8.272
</td>
<td style="text-align:right;">
41358
</td>
<td style="text-align:right;">
12.778
</td>
<td style="text-align:right;">
10.222
</td>
<td style="text-align:right;">
51112
</td>
<td style="text-align:right;">
41358
</td>
<td style="text-align:right;">
8.272
</td>
<td style="text-align:right;">
51112
</td>
<td style="text-align:right;">
10.222
</td>
<td style="text-align:right;">
12.778
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
death
</td>
<td style="text-align:right;">
12.778
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
10.34
</td>
<td style="text-align:right;">
8.27
</td>
<td style="text-align:right;">
41358
</td>
<td style="text-align:right;">
51112
</td>
<td style="text-align:right;">
10.22
</td>
<td style="text-align:right;">
12.78
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
12.778
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
sick
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
7.75
</td>
<td style="text-align:right;">
4.14
</td>
<td style="text-align:right;">
58485
</td>
<td style="text-align:right;">
68551
</td>
<td style="text-align:right;">
4.78
</td>
<td style="text-align:right;">
9.02
</td>
<td style="text-align:right;">
0.887
</td>
<td style="text-align:right;">
0.710
</td>
<td style="text-align:right;">
3549
</td>
<td style="text-align:right;">
0.901
</td>
<td style="text-align:right;">
0.721
</td>
<td style="text-align:right;">
3604
</td>
<td style="text-align:right;">
3549
</td>
<td style="text-align:right;">
0.710
</td>
<td style="text-align:right;">
3604
</td>
<td style="text-align:right;">
0.721
</td>
<td style="text-align:right;">
0.901
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
sicker
</td>
<td style="text-align:right;">
0.901
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
7.75
</td>
<td style="text-align:right;">
4.14
</td>
<td style="text-align:right;">
58485
</td>
<td style="text-align:right;">
68551
</td>
<td style="text-align:right;">
4.78
</td>
<td style="text-align:right;">
9.02
</td>
<td style="text-align:right;">
6.867
</td>
<td style="text-align:right;">
3.434
</td>
<td style="text-align:right;">
54937
</td>
<td style="text-align:right;">
8.118
</td>
<td style="text-align:right;">
4.059
</td>
<td style="text-align:right;">
64947
</td>
<td style="text-align:right;">
54937
</td>
<td style="text-align:right;">
3.434
</td>
<td style="text-align:right;">
64947
</td>
<td style="text-align:right;">
4.059
</td>
<td style="text-align:right;">
9.019
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
death
</td>
<td style="text-align:right;">
9.019
</td>
<td style="text-align:right;">
0.901
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
7.75
</td>
<td style="text-align:right;">
4.14
</td>
<td style="text-align:right;">
58485
</td>
<td style="text-align:right;">
68551
</td>
<td style="text-align:right;">
4.78
</td>
<td style="text-align:right;">
9.02
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
9.019
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
sick
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
10.94
</td>
<td style="text-align:right;">
5.57
</td>
<td style="text-align:right;">
86287
</td>
<td style="text-align:right;">
108582
</td>
<td style="text-align:right;">
6.96
</td>
<td style="text-align:right;">
13.73
</td>
<td style="text-align:right;">
0.317
</td>
<td style="text-align:right;">
0.253
</td>
<td style="text-align:right;">
1266
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
0.255
</td>
<td style="text-align:right;">
1273
</td>
<td style="text-align:right;">
1266
</td>
<td style="text-align:right;">
0.253
</td>
<td style="text-align:right;">
1273
</td>
<td style="text-align:right;">
0.255
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
sicker
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
10.94
</td>
<td style="text-align:right;">
5.57
</td>
<td style="text-align:right;">
86287
</td>
<td style="text-align:right;">
108582
</td>
<td style="text-align:right;">
6.96
</td>
<td style="text-align:right;">
13.73
</td>
<td style="text-align:right;">
10.628
</td>
<td style="text-align:right;">
5.314
</td>
<td style="text-align:right;">
85020
</td>
<td style="text-align:right;">
13.414
</td>
<td style="text-align:right;">
6.707
</td>
<td style="text-align:right;">
107309
</td>
<td style="text-align:right;">
85020
</td>
<td style="text-align:right;">
5.314
</td>
<td style="text-align:right;">
107309
</td>
<td style="text-align:right;">
6.707
</td>
<td style="text-align:right;">
13.732
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
death
</td>
<td style="text-align:right;">
13.732
</td>
<td style="text-align:right;">
0.318
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
10.94
</td>
<td style="text-align:right;">
5.57
</td>
<td style="text-align:right;">
86287
</td>
<td style="text-align:right;">
108582
</td>
<td style="text-align:right;">
6.96
</td>
<td style="text-align:right;">
13.73
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
13.732
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
sick
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
8.61
</td>
<td style="text-align:right;">
5.24
</td>
<td style="text-align:right;">
56449
</td>
<td style="text-align:right;">
68546
</td>
<td style="text-align:right;">
6.10
</td>
<td style="text-align:right;">
10.22
</td>
<td style="text-align:right;">
3.116
</td>
<td style="text-align:right;">
2.493
</td>
<td style="text-align:right;">
12463
</td>
<td style="text-align:right;">
3.296
</td>
<td style="text-align:right;">
2.637
</td>
<td style="text-align:right;">
13183
</td>
<td style="text-align:right;">
12463
</td>
<td style="text-align:right;">
2.493
</td>
<td style="text-align:right;">
13183
</td>
<td style="text-align:right;">
2.637
</td>
<td style="text-align:right;">
3.296
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
sicker
</td>
<td style="text-align:right;">
3.296
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
int
</td>
<td style="text-align:right;">
8.61
</td>
<td style="text-align:right;">
5.24
</td>
<td style="text-align:right;">
56449
</td>
<td style="text-align:right;">
68546
</td>
<td style="text-align:right;">
6.10
</td>
<td style="text-align:right;">
10.22
</td>
<td style="text-align:right;">
5.498
</td>
<td style="text-align:right;">
2.749
</td>
<td style="text-align:right;">
43986
</td>
<td style="text-align:right;">
6.920
</td>
<td style="text-align:right;">
3.460
</td>
<td style="text-align:right;">
55363
</td>
<td style="text-align:right;">
43986
</td>
<td style="text-align:right;">
2.749
</td>
<td style="text-align:right;">
55363
</td>
<td style="text-align:right;">
3.460
</td>
<td style="text-align:right;">
10.216
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>We can also check what has been the absolute number of events per
strategy.</p>
<table class="table table table-striped table-hover table-condensed table-responsive" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
arm
</th>
<th style="text-align:left;">
evtname
</th>
<th style="text-align:right;">
n
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
int
</td>
<td style="text-align:left;">
death
</td>
<td style="text-align:right;">
1000
</td>
</tr>
<tr>
<td style="text-align:left;">
int
</td>
<td style="text-align:left;">
sick
</td>
<td style="text-align:right;">
1000
</td>
</tr>
<tr>
<td style="text-align:left;">
int
</td>
<td style="text-align:left;">
sicker
</td>
<td style="text-align:right;">
827
</td>
</tr>
<tr>
<td style="text-align:left;">
noint
</td>
<td style="text-align:left;">
death
</td>
<td style="text-align:right;">
1000
</td>
</tr>
<tr>
<td style="text-align:left;">
noint
</td>
<td style="text-align:left;">
sick
</td>
<td style="text-align:right;">
1000
</td>
</tr>
<tr>
<td style="text-align:left;">
noint
</td>
<td style="text-align:left;">
sicker
</td>
<td style="text-align:right;">
880
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="plots">Plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<p>We now use the data output to plot the histograms/densities of the
simulation.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_plot</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">merged_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">evtname</span> <span class="op">!=</span> <span class="st">"sick"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">arm</span>,<span class="va">evtname</span>,<span class="va">simulation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">evttime</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_plot</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">arm</span>, x <span class="op">=</span> <span class="va">evttime</span><span class="op">)</span>,</span>
<span>               alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept<span class="op">=</span><span class="va">median</span>,col<span class="op">=</span><span class="va">arm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span> <span class="op">~</span> <span class="va">evtname</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_ssd_files/figure-html/post-processing_plots1-1.png" width="960"></p>
<p>We can also plot the patient level incremental QALY/costs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_qaly_cost</span><span class="op">&lt;-</span> <span class="va">psa_ipd</span><span class="op">[</span>,<span class="va">.SD</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">pat_id</span>,<span class="va">arm</span>,<span class="va">simulation</span><span class="op">)</span><span class="op">]</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">arm</span>,qaly<span class="op">=</span><span class="va">total_qalys</span>,cost<span class="op">=</span><span class="va">total_costs</span>,<span class="va">pat_id</span>,<span class="va">simulation</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data_qaly_cost</span><span class="op">[</span>,<span class="va">ps_id</span><span class="op">:=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">pat_id</span>,<span class="va">simulation</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">mean_data_qaly_cost</span> <span class="op">&lt;-</span> <span class="va">data_qaly_cost</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">arm</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html" class="external-link">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>,<span class="va">mean</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_qaly_cost</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">qaly</span>, y <span class="op">=</span> <span class="va">cost</span>, col <span class="op">=</span> <span class="va">arm</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.15</span>,shape <span class="op">=</span> <span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">mean_data_qaly_cost</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">qaly</span>, y <span class="op">=</span> <span class="va">cost</span>, fill <span class="op">=</span> <span class="va">arm</span><span class="op">)</span>, shape <span class="op">=</span> <span class="fl">21</span>,col<span class="op">=</span><span class="st">"black"</span>,size<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_ssd_files/figure-html/post-processing_plots-1.png" width="960"></p>
</div>
</div>
<div class="section level2">
<h2 id="sensitivity-analysis">Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis"></a>
</h2>
<div class="section level3">
<h3 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h3>
<p>In this case, inputs must be created first to change across
sensitivity analysis. To do so, the item list
<code>sensitivity_inputs</code> can be used. In this case, we also use
<code>pick_val_v</code> which allows the model to automatically pick the
relevant value (no PSA, PSA or sensitivity analysis) based on the
corresponding boolean flags of psa_bool and sensitivity_bool. In this
case we also use the <code>sens</code> iterator for each sensitivity
analysis and the <code>n_sensitivity</code> which is an argument in
<code>run_sim</code>.</p>
<p>Note that we have then just changed how the inputs are handled in
common_all_inputs, but the same could be done with unique_pt_inputs, but
in those cases, as the inputs change per patient, the
<code>pick_val_v</code> or <code>pick_val</code> functions should be
applied within unique_pt_inputs to make sure they are evaluated when it
correspond.</p>
<p>Note that for the psa we are directly calling the distributions and
passing the parameters.Note also that the <code>sens_name_used</code> is
automatically computed by the engine and is accesible to the user (it’s
the name of the sensitivity analysis, e.g., “scenario 1”).</p>
<p>The indicator parameter in <code>pick_val_v</code> and
<code>pick_val</code> is used to determine which parameters are left “as
is” and which ones are to be substituted with the sensitivity value.
There are two ways to do this, either by setting it in a binary way (1
or 0), or by using the indicator as the number of the parameter values
to be varied (useful when several parameters are varied at the same
time, or only specific values of a vector are varied). This can be set
by using <code>indicator_sens_binary</code> argument.</p>
<p>Note that <code>pick_val_v</code> and <code>pick_val</code> can be
directly loaded as parameters (in fact, a named list will be loaded
directly by R). A small tweak is needed if it’s the first item added, in
which the item list must be initiated by using <code><a href="../reference/add_item.html">add_item()</a></code>
(see below). Note that one can use a list of lists in the case where the
base_value or any of the other parameters are vectors instead of
elements of length 1. In this case, we showcase a list but it could also
use a data.frame.</p>
<p><code>pick_psa</code> can be used to select the correct PSA
distributions.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Load some data</span></span>
<span><span class="va">list_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>parameter_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"util.sick"</span>,<span class="st">"util.sicker"</span>,<span class="st">"cost.sick"</span>,<span class="st">"cost.sicker"</span>,<span class="st">"cost.int"</span>,<span class="st">"coef_noint"</span>,<span class="st">"HR_int"</span><span class="op">)</span>,</span>
<span>                              base_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">3000</span>,<span class="fl">7000</span>,<span class="fl">1000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,<span class="fl">0.8</span><span class="op">)</span>,</span>
<span>                              DSA_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">1000</span>,<span class="fl">5000</span>,<span class="fl">800</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                              DSA_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">0.7</span>,<span class="fl">5000</span>,<span class="fl">9000</span>,<span class="fl">2000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.4</span><span class="op">)</span>,<span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                              PSA_dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"rnorm"</span>,<span class="st">"rbeta_mse"</span>,<span class="st">"rgamma_mse"</span>,<span class="st">"rgamma_mse"</span>,<span class="st">"rgamma_mse"</span>,<span class="st">"rnorm"</span>,<span class="st">"rlnorm"</span><span class="op">)</span>,</span>
<span>                              a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">3000</span>,<span class="fl">7000</span>,<span class="fl">1000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              b<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.8</span>,<span class="fl">0.5</span>,<span class="fl">3000</span>,<span class="fl">7000</span>,<span class="fl">1000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              scenario_1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.6</span>,<span class="fl">0.3</span>,<span class="fl">1000</span>,<span class="fl">5000</span>,<span class="fl">800</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,<span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                              scenario_2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">0.9</span>,<span class="fl">0.7</span>,<span class="fl">5000</span>,<span class="fl">9000</span>,<span class="fl">2000</span>,<span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.4</span><span class="op">)</span>,<span class="fl">0.9</span><span class="op">)</span></span>
<span>                              <span class="op">)</span></span>
<span></span>
<span><span class="va">sensitivity_inputs</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span></span>
<span>            indicators <span class="op">=</span> <span class="kw">if</span><span class="op">(</span><span class="va">sensitivity_bool</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="../reference/create_indicators.html">create_indicators</a></span><span class="op">(</span><span class="va">sens</span>,<span class="va">n_sensitivity</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sensitivity_names</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>                                <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="co">#vector of indicators, value 0 everywhere except at sens, where it takes value 1 (for dsa_min and dsa_max, if not sensitivity analysis, then we activate all of them, i.e., in a PSA)</span></span>
<span>                              <span class="op">)</span></span>
<span></span>
<span><span class="va">common_all_inputs</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="../reference/pick_val_v.html">pick_val_v</a></span><span class="op">(</span>base        <span class="op">=</span> <span class="va">list_par</span><span class="op">[[</span><span class="st">"base_value"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       psa         <span class="op">=</span> <span class="fu"><a href="../reference/pick_psa.html">pick_psa</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="st">"PSA_dist"</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="st">"PSA_dist"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="va">list_par</span><span class="op">[[</span><span class="st">"a"</span><span class="op">]</span><span class="op">]</span>,<span class="va">list_par</span><span class="op">[[</span><span class="st">"b"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                       sens        <span class="op">=</span> <span class="va">list_par</span><span class="op">[[</span><span class="va">sens_name_used</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                       psa_ind     <span class="op">=</span> <span class="va">psa_bool</span>,</span>
<span>                       sens_ind    <span class="op">=</span> <span class="va">sensitivity_bool</span>,</span>
<span>                       indicator   <span class="op">=</span> <span class="va">indicators</span>,</span>
<span>                       names_out   <span class="op">=</span> <span class="va">list_par</span><span class="op">[[</span><span class="st">"parameter_name"</span><span class="op">]</span><span class="op">]</span></span>
<span>                       <span class="op">)</span></span>
<span>            <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/add_item.html">add_item</a></span><span class="op">(</span>random_seed_sicker_i <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>,<span class="fl">1000</span>,replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="co">#we don't add this variable ot the sensitivity analysis</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-execution-1">Model Execution<a class="anchor" aria-label="anchor" href="#model-execution-1"></a>
</h3>
<p>The model is executed as before, just adding the
<code>sensitivity_inputs</code>, <code>sensitivity_names</code>,
<code>sensitivity_bool</code> and <code>n_sensitivity</code> arguments.
Note that the total number of sensitivity iterations is given not by
n_sensitivity, but by n_sensitivity * length(sensitivity_names), so in
this case it will be 2 x n_sensitivity, or 2 x 7 = 14. For two scenario
analysis it would be 2 x 1 = 2, with the <code>indicators</code>
variable defined in the previous section taking value 1 for all the
variables altered in the scenario, and 0 otherwise.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="fl">100</span>,                               <span class="co"># number of patients to be simulated</span></span>
<span>  n_sim<span class="op">=</span><span class="fl">1</span>,                                  <span class="co"># number of simulations to run</span></span>
<span>  psa_bool <span class="op">=</span> <span class="cn">FALSE</span>,                         <span class="co"># use PSA or not. If n_sim &gt; 1 and psa_bool = FALSE, then difference in outcomes is due to sampling (number of pats simulated)  </span></span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>,             <span class="co"># intervention list</span></span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs</span>,    <span class="co"># inputs common that do not change within a simulation</span></span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,      <span class="co"># inputs that change within a simulation but are not affected by the intervention</span></span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,      <span class="co"># inputs that change within a simulation between interventions</span></span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        <span class="co"># initial event list</span></span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          <span class="co"># reaction of events</span></span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  sensitivity_inputs <span class="op">=</span> <span class="va">sensitivity_inputs</span>,</span>
<span>  sensitivity_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DSA_min"</span>,<span class="st">"DSA_max"</span><span class="op">)</span>,</span>
<span>  sensitivity_bool <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_sensitivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  input_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="st">"parameter_name"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 2</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 2: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 3</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 3: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 4</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 4: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 5</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 5: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 6</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 6: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 7</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 7: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 8</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 8: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 9</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 9: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 10</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 10: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 11</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 11: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 12</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 12: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 13</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 13: 0.17s</span></span>
<span><span class="co">#&gt; Analysis number: 14</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 14: 0.18s</span></span>
<span><span class="co">#&gt; Total time to run: 2.4s</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-results">Check results<a class="anchor" aria-label="anchor" href="#check-results"></a>
</h3>
<p>We briefly check below that indeed the engine has been changing the
corresponding parameter value.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_sensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_depth.html" class="external-link">map_depth</a></span><span class="op">(</span><span class="va">results</span>,<span class="fl">2</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Check mean value across iterations as PSA is off</span></span>
<span><span class="va">data_sensitivity</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sensitivity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"util.sick"</span>,<span class="st">"util.sicker"</span>,<span class="st">"cost.sick"</span>,<span class="st">"cost.sicker"</span>,<span class="st">"cost.int"</span>,<span class="st">"coef_noint"</span>,<span class="st">"HR_int"</span><span class="op">)</span>,<span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 8</span></span></span>
<span><span class="co">#&gt;    sensitivity util.sick util.sicker cost.sick cost.sicker cost.int coef_noint</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1       0.6         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2       0.8         0.3      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3       0.8         0.5      <span style="text-decoration: underline;">1</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">5</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000      800      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">2.30</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>          11       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>          12       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>          13       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>          14       0.8         0.5      <span style="text-decoration: underline;">3</span>000        <span style="text-decoration: underline;">7</span>000     <span style="text-decoration: underline;">1</span>000      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: HR_int &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-execution-probabilistic-dsa">Model Execution, probabilistic DSA<a class="anchor" aria-label="anchor" href="#model-execution-probabilistic-dsa"></a>
</h3>
<p>The model is executed as before, just activating the psa_bool
option</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="fl">100</span>,                               </span>
<span>  n_sim<span class="op">=</span><span class="fl">6</span>,                                  </span>
<span>  psa_bool <span class="op">=</span> <span class="cn">TRUE</span>,                         </span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>,             </span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs</span>,    </span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,      </span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,      </span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        </span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          </span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  sensitivity_inputs <span class="op">=</span> <span class="va">sensitivity_inputs</span>,</span>
<span>  sensitivity_names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DSA_min"</span>,<span class="st">"DSA_max"</span><span class="op">)</span>,</span>
<span>  sensitivity_bool <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_sensitivity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  input_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="st">"parameter_name"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.2s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 1.05s</span></span>
<span><span class="co">#&gt; Analysis number: 2</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.16s</span></span>
<span><span class="co">#&gt; Time to run analysis 2: 1.01s</span></span>
<span><span class="co">#&gt; Analysis number: 3</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 3: 1.03s</span></span>
<span><span class="co">#&gt; Analysis number: 4</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.18s</span></span>
<span><span class="co">#&gt; Time to run analysis 4: 1.04s</span></span>
<span><span class="co">#&gt; Analysis number: 5</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.35s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.16s</span></span>
<span><span class="co">#&gt; Time to run analysis 5: 1.2s</span></span>
<span><span class="co">#&gt; Analysis number: 6</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 6: 0.98s</span></span>
<span><span class="co">#&gt; Analysis number: 7</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.19s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.16s</span></span>
<span><span class="co">#&gt; Time to run analysis 7: 1.02s</span></span>
<span><span class="co">#&gt; Analysis number: 8</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 8: 1.02s</span></span>
<span><span class="co">#&gt; Analysis number: 9</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.16s</span></span>
<span><span class="co">#&gt; Time to run analysis 9: 1.02s</span></span>
<span><span class="co">#&gt; Analysis number: 10</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 10: 1.02s</span></span>
<span><span class="co">#&gt; Analysis number: 11</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.16s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 11: 1.03s</span></span>
<span><span class="co">#&gt; Analysis number: 12</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.18s</span></span>
<span><span class="co">#&gt; Time to run analysis 12: 1.04s</span></span>
<span><span class="co">#&gt; Analysis number: 13</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.2s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.17s</span></span>
<span><span class="co">#&gt; Time to run analysis 13: 1.07s</span></span>
<span><span class="co">#&gt; Analysis number: 14</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.18s</span></span>
<span><span class="co">#&gt; Time to run analysis 14: 1.06s</span></span>
<span><span class="co">#&gt; Total time to run: 14.59s</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-results-1">Check results<a class="anchor" aria-label="anchor" href="#check-results-1"></a>
</h3>
<p>We briefly check below that indeed the engine has been changing the
corresponding parameter value.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_sensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_depth.html" class="external-link">map_depth</a></span><span class="op">(</span><span class="va">results</span>,<span class="fl">2</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Check mean value across iterations as PSA is off</span></span>
<span><span class="va">data_sensitivity</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sensitivity</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"util.sick"</span>,<span class="st">"util.sicker"</span>,<span class="st">"cost.sick"</span>,<span class="st">"cost.sicker"</span>,<span class="st">"cost.int"</span>,<span class="st">"coef_noint"</span>,<span class="st">"HR_int"</span><span class="op">)</span>,<span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 14 × 8</span></span></span>
<span><span class="co">#&gt;    sensitivity util.sick util.sicker cost.sick cost.sicker cost.int coef_noint</span></span>
<span><span class="co">#&gt;          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>           1     0.6         0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>           2     0.722       0.3       <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>           3     0.722       0.580     <span style="text-decoration: underline;">1</span>000        <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>           4     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">5</span>000     <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>           5     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.     800       -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>           6     0.725       0.579     <span style="text-decoration: underline;">3</span>140.       <span style="text-decoration: underline;">7</span>957.    <span style="text-decoration: underline;">1</span>065.      -<span style="color: #BB0000;">2.30</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>           7     0.722       0.580     <span style="text-decoration: underline;">3</span>155.       <span style="text-decoration: underline;">7</span>973.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.62</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>           8     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>           9     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>          10     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>          11     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>          12     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>          13     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>          14     0.722       0.580     <span style="text-decoration: underline;">3</span>156.       <span style="text-decoration: underline;">7</span>974.    <span style="text-decoration: underline;">1</span>061.      -<span style="color: #BB0000;">1.61</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: HR_int &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-execution-simple-psa">Model Execution, Simple PSA<a class="anchor" aria-label="anchor" href="#model-execution-simple-psa"></a>
</h3>
<p>The model is executed as before, just activating the psa_bool option
and deactivating the sensitivity_bool and removing sensitivity_names and
setting n_sensitivity = 1</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_sim.html">run_sim</a></span><span class="op">(</span>  </span>
<span>  npats<span class="op">=</span><span class="fl">100</span>,                               </span>
<span>  n_sim<span class="op">=</span><span class="fl">10</span>,                                  </span>
<span>  psa_bool <span class="op">=</span> <span class="cn">TRUE</span>,                         </span>
<span>  arm_list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"int"</span>, <span class="st">"noint"</span><span class="op">)</span>,             </span>
<span>  common_all_inputs <span class="op">=</span> <span class="va">common_all_inputs</span>,    </span>
<span>  common_pt_inputs <span class="op">=</span> <span class="va">common_pt_inputs</span>,      </span>
<span>  unique_pt_inputs <span class="op">=</span> <span class="va">unique_pt_inputs</span>,      </span>
<span>  init_event_list <span class="op">=</span> <span class="va">init_event_list</span>,        </span>
<span>  evt_react_list <span class="op">=</span> <span class="va">evt_react_list</span>,          </span>
<span>  util_ongoing_list <span class="op">=</span> <span class="va">util_ongoing</span>,</span>
<span>  cost_ongoing_list <span class="op">=</span> <span class="va">cost_ongoing</span>,</span>
<span>  sensitivity_inputs <span class="op">=</span> <span class="va">sensitivity_inputs</span>,</span>
<span>  sensitivity_bool <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_sensitivity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  input_out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">list_par</span><span class="op">[[</span><span class="st">"parameter_name"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Analysis number: 1</span></span>
<span><span class="co">#&gt; Simulation number: 1</span></span>
<span><span class="co">#&gt; Time to run simulation 1: 0.2s</span></span>
<span><span class="co">#&gt; Simulation number: 2</span></span>
<span><span class="co">#&gt; Time to run simulation 2: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 3</span></span>
<span><span class="co">#&gt; Time to run simulation 3: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 4</span></span>
<span><span class="co">#&gt; Time to run simulation 4: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 5</span></span>
<span><span class="co">#&gt; Time to run simulation 5: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 6</span></span>
<span><span class="co">#&gt; Time to run simulation 6: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 7</span></span>
<span><span class="co">#&gt; Time to run simulation 7: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 8</span></span>
<span><span class="co">#&gt; Time to run simulation 8: 0.17s</span></span>
<span><span class="co">#&gt; Simulation number: 9</span></span>
<span><span class="co">#&gt; Time to run simulation 9: 0.18s</span></span>
<span><span class="co">#&gt; Simulation number: 10</span></span>
<span><span class="co">#&gt; Time to run simulation 10: 0.18s</span></span>
<span><span class="co">#&gt; Time to run analysis 1: 1.8s</span></span>
<span><span class="co">#&gt; Total time to run: 1.8s</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-results-2">Check results<a class="anchor" aria-label="anchor" href="#check-results-2"></a>
</h3>
<p>We briefly check below that indeed the engine has been changing the
corresponding parameter values.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_simulation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_depth.html" class="external-link">map_depth</a></span><span class="op">(</span><span class="va">results</span>,<span class="fl">2</span>, <span class="st">"merged_df"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Check mean value across iterations as PSA is off</span></span>
<span><span class="va">data_simulation</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">simulation</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html" class="external-link">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"util.sick"</span>,<span class="st">"util.sicker"</span>,<span class="st">"cost.sick"</span>,<span class="st">"cost.sicker"</span>,<span class="st">"cost.int"</span>,<span class="st">"coef_noint"</span>,<span class="st">"HR_int"</span><span class="op">)</span>,<span class="va">mean</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">#&gt;    simulation util.sick util.sicker cost.sick cost.sicker cost.int coef_noint</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>          1     0.528       0.563     <span style="text-decoration: underline;">5</span>010.       <span style="text-decoration: underline;">9</span>352.    <span style="text-decoration: underline;">1</span>073.      -<span style="color: #BB0000;">1.43</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>          2     0.666       0.544     <span style="text-decoration: underline;">3</span>065.       <span style="text-decoration: underline;">7</span>914.     808.      -<span style="color: #BB0000;">1.07</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>          3     0.742       0.526     <span style="text-decoration: underline;">2</span>393.       <span style="text-decoration: underline;">7</span>690.    <span style="text-decoration: underline;">1</span>323.      -<span style="color: #BB0000;">1.99</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>          4     0.727       0.767     <span style="text-decoration: underline;">2</span>491.       <span style="text-decoration: underline;">8</span>069.    <span style="text-decoration: underline;">1</span>009.      -<span style="color: #BB0000;">1.34</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>          5     0.808       0.570     <span style="text-decoration: underline;">4</span>021.       <span style="text-decoration: underline;">7</span>834.    <span style="text-decoration: underline;">1</span>026.      -<span style="color: #BB0000;">1.93</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>          6     0.874       0.501     <span style="text-decoration: underline;">1</span>881.       <span style="text-decoration: underline;">6</span>913.    <span style="text-decoration: underline;">1</span>158.      -<span style="color: #BB0000;">2.01</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>          7     0.859       0.457     <span style="text-decoration: underline;">2</span>730.       <span style="text-decoration: underline;">9</span>349.    <span style="text-decoration: underline;">1</span>264.      -<span style="color: #BB0000;">1.70</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>          8     0.935       0.438     <span style="text-decoration: underline;">3</span>954.       <span style="text-decoration: underline;">6</span>225.     813.      -<span style="color: #BB0000;">1.35</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>          9     0.886       0.648     <span style="text-decoration: underline;">3</span>104.       <span style="text-decoration: underline;">7</span>909.     695.      -<span style="color: #BB0000;">1.75</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>         10     0.870       0.576     <span style="text-decoration: underline;">3</span>952.       <span style="text-decoration: underline;">6</span>264.    <span style="text-decoration: underline;">1</span>176.      -<span style="color: #BB0000;">1.52</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1 more variable: HR_int &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Javier Sanchez Alvarez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
