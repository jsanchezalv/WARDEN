<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform luck adjustment — luck_adj • WARDEN</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform luck adjustment — luck_adj"><meta name="description" content="Perform luck adjustment"><meta property="og:description" content="Perform luck adjustment"><meta property="og:image" content="https://jsanchezalv.github.io/WARDEN/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZEDNGW5QRP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZEDNGW5QRP);
</script><!-- Google tag (gtag.js) --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WARDEN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="View Index"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/warden_explained.html">Warden Explained</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd.html">Example in a Sick-Sicker-Dead Model</a></li>
    <li><a class="dropdown-item" href="../articles/inputs_selector.html">How to Use the Automatic Input Selector</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_stream.html">Example in a Sick-Sicker-Dead Model - Random Number Streams &amp; Luck Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_sobol.html">Example in a Sick-Sicker-Dead Model - Quasi-Random Sobol Sequence vs. Purely Random</a></li>
    <li><a class="dropdown-item" href="../articles/example_eBC.html">Example in Early Breast Cancer</a></li>
    <li><a class="dropdown-item" href="../articles/example_markov.html">Example in a Markov Model</a></li>
    <li><a class="dropdown-item" href="../articles/example_uncertainty.html">Structural and Parametric Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/example_ipd.html">Example for Individual Patient Data</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jsanchezalv/WARDEN" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Perform luck adjustment</h1>
      <small class="dont-index">Source: <a href="https://github.com/jsanchezalv/WARDEN/blob/main/R/input_f.R" class="external-link"><code>R/input_f.R</code></a></small>
      <div class="d-none name"><code>luck_adj.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform luck adjustment</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">luck_adj</span><span class="op">(</span><span class="va">prevsurv</span>, <span class="va">cursurv</span>, <span class="va">luck</span>, condq <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-prevsurv">prevsurv<a class="anchor" aria-label="anchor" href="#arg-prevsurv"></a></dt>
<dd><p>Value of the previous survival</p></dd>


<dt id="arg-cursurv">cursurv<a class="anchor" aria-label="anchor" href="#arg-cursurv"></a></dt>
<dd><p>Value of the current survival</p></dd>


<dt id="arg-luck">luck<a class="anchor" aria-label="anchor" href="#arg-luck"></a></dt>
<dd><p>Luck used to be adjusted (number between 0 and 1)</p></dd>


<dt id="arg-condq">condq<a class="anchor" aria-label="anchor" href="#arg-condq"></a></dt>
<dd><p>Conditional quantile approach or standard approach</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Adjusted luck number between 0 and 1</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs the luck adjustment automatically for the user, returning the adjusted luck number.
Luck is interpreted in the same fashion as is standard in R (higher luck, higher time to event).</p>
<p>Note that if TTE is predicted using a conditional quantile function (e.g., conditional gompertz, conditional quantile weibull...) <code>prevsurv</code> and <code>cursurv</code>
are the unconditional survival using the "previous" parametrization but at the previous time for <code>presurv</code> and at the current time for <code>cursurv</code>.
For other distributions, <code>presurv</code> is the survival up to current time using the previous parametrization, and <code>cursurv</code>
is the survival up to current time using the current parametrization.</p>
<p>Note that the advantage of the conditional quantile function is that it does not need the new parametrization to update the luck,
which makes this approach computationally more efficient.
This function can also work with vectors, which could allow to update multiple lucks in a single approach, and it can preserve names</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">luck_adj</span><span class="op">(</span>prevsurv <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span> cursurv <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span> luck <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span> condq <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4285714</span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu">luck_adj</span><span class="op">(</span>prevsurv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.8</span>,<span class="fl">0.7</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> cursurv <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>,<span class="fl">0.6</span>,<span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.6</span>,<span class="fl">0.7</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span>,<span class="st">"C"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> condq <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         A         B         C </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.2857143 0.4666667 0.5800000 </span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu">luck_adj</span><span class="op">(</span>prevsurv <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span> cursurv <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span> luck <span class="op">=</span> <span class="fl">0.5</span>,</span></span>
<span class="r-in"><span> condq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#different results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5625</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Unconditional approach, timepoint of change is 25,</span></span></span>
<span class="r-in"><span><span class="co"># parameter goes from 0.02 at time 10 to 0.025 to 0.015 at time 25,</span></span></span>
<span class="r-in"><span><span class="co">#  starting luck is 0.37</span></span></span>
<span class="r-in"><span><span class="va">new_luck</span> <span class="op">&lt;-</span> <span class="fu">luck_adj</span><span class="op">(</span>prevsurv <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.02</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> cursurv <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.025</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> luck <span class="op">=</span> <span class="fl">0.37</span>,</span></span>
<span class="r-in"><span> condq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#time 10 change</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="va">new_luck</span> <span class="op">&lt;-</span> <span class="fu">luck_adj</span><span class="op">(</span>prevsurv <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">25</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.025</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> cursurv <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">25</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.015</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> luck <span class="op">=</span> <span class="va">new_luck</span>,</span></span>
<span class="r-in"><span> condq <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co">#time 25 change</span></span></span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">qweibull</a></span><span class="op">(</span><span class="va">new_luck</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">0.015</span><span class="op">)</span> <span class="co">#final TTE </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 43.52338</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Conditional quantile approach </span></span></span>
<span class="r-in"><span><span class="va">new_luck</span> <span class="op">&lt;-</span> <span class="fu">luck_adj</span><span class="op">(</span>prevsurv <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">0</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.02</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      cursurv <span class="op">=</span> <span class="fl">1</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.02</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      luck <span class="op">=</span> <span class="fl">0.37</span>,</span></span>
<span class="r-in"><span>                      condq <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#time 10 change, previous time is 0 so prevsurv will be 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">new_luck</span> <span class="op">&lt;-</span> <span class="fu">luck_adj</span><span class="op">(</span>prevsurv <span class="op">=</span> <span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">10</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.025</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      cursurv <span class="op">=</span> <span class="fl">1</span><span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">pweibull</a></span><span class="op">(</span>q<span class="op">=</span><span class="fl">25</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">0.025</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      luck <span class="op">=</span> <span class="va">new_luck</span>,</span></span>
<span class="r-in"><span>                      condq <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#time 25 change</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="qcond_weibull.html">qcond_weibull</a></span><span class="op">(</span>rnd <span class="op">=</span> <span class="va">new_luck</span>,</span></span>
<span class="r-in"><span>                     shape <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                     scale <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">0.015</span>,</span></span>
<span class="r-in"><span>                     lower_bound <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span> <span class="fl">25</span> <span class="co">#final TTE</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 43.52338</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Javier Sanchez Alvarez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

