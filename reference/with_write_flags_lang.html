<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Evaluate a language object with write-tracking via active bindings — with_write_flags_lang • WARDEN</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Evaluate a language object with write-tracking via active bindings — with_write_flags_lang"><meta name="description" content="Temporarily installs active bindings for a set of variable names in
env so that any write to those names during the evaluation of
expr_lang flips a corresponding *_lastupdate flag in env.
This flags assignments even when the value is overwritten with the same
value, and does not flag branches that are not executed."><meta property="og:description" content="Temporarily installs active bindings for a set of variable names in
env so that any write to those names during the evaluation of
expr_lang flips a corresponding *_lastupdate flag in env.
This flags assignments even when the value is overwritten with the same
value, and does not flag branches that are not executed."><meta property="og:image" content="https://jsanchezalv.github.io/WARDEN/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZEDNGW5QRP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZEDNGW5QRP');
</script><!-- Google tag (gtag.js) --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WARDEN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="View Index"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Core Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/warden_explained.html">Warden Explained</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd.html">Sick-Sicker-Dead Model (SSD)</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_constrained.html">Resource Constrained SSD model</a></li>
    <li><a class="dropdown-item" href="../articles/inputs_selector.html">How to Use the Automatic Input Selector</a></li>
    <li><a class="dropdown-item" href="../articles/example_eBC.html">Early Breast Cancer</a></li>
    <li><a class="dropdown-item" href="../articles/example_ipd.html">Using Individual Patient Data</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Other Tutorials and Best Practices</h6></li>
    <li><a class="dropdown-item" href="../articles/example_markov.html">Cohort Markov Model</a></li>
    <li><a class="dropdown-item" href="../articles/example_avoiding_cycles.html">How to Avoid Using Cycles to Speed Up Model</a></li>
    <li><a class="dropdown-item" href="../articles/example_uncertainty.html">Structural and Parametric Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_stream.html">Random Number Streams &amp; Luck Adjustment (SSD model)</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_sobol.html">Quasi-Random Sobol Sequence vs. Purely Random (SSD model)</a></li>
    <li><a class="dropdown-item" href="../articles/example_colon_degeling.html">Degeling (2025) using WARDEN instead of simmer</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jsanchezalv/WARDEN" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Evaluate a language object with write-tracking via active bindings</h1>
      <small class="dont-index">Source: <a href="https://github.com/jsanchezalv/WARDEN/blob/main/R/engine_helper_f.R" class="external-link"><code>R/engine_helper_f.R</code></a></small>
      <div class="d-none name"><code>with_write_flags_lang.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Temporarily installs <strong>active bindings</strong> for a set of variable names in
<code>env</code> so that any <strong>write</strong> to those names during the evaluation of
<code>expr_lang</code> flips a corresponding <code>*_lastupdate</code> flag in <code>env</code>.
This flags assignments even when the value is overwritten with the same
value, and does not flag branches that are not executed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">with_write_flags_lang</span><span class="op">(</span><span class="va">expr_lang</span>, <span class="va">tracked</span>, <span class="va">env</span>, flag_value <span class="op">=</span> <span class="fl">1L</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expr-lang">expr_lang<a class="anchor" aria-label="anchor" href="#arg-expr-lang"></a></dt>
<dd><p>A language object (call or expression) to evaluate.
For example, <code>react_list[[i]][["react"]]</code> returned by <code><a href="add_reactevt.html">add_reactevt()</a></code>.</p></dd>


<dt id="arg-tracked">tracked<a class="anchor" aria-label="anchor" href="#arg-tracked"></a></dt>
<dd><p>Character vector of <strong>top-level</strong> variable names to track
(e.g., <code>c("q_default","c_default","curtime")</code>). For each name <code>nm</code>,
an active binding is installed at <code>env[[nm]]</code>, and writes set
<code>env[[paste0(nm, "_lastupdate")]] &lt;- flag_value</code>.</p></dd>


<dt id="arg-env">env<a class="anchor" aria-label="anchor" href="#arg-env"></a></dt>
<dd><p>Environment in which to install the bindings and evaluate
<code>expr_lang</code> (your per-patient/per-arm working environment).</p></dd>


<dt id="arg-flag-value">flag_value<a class="anchor" aria-label="anchor" href="#arg-flag-value"></a></dt>
<dd><p>Scalar written into each <code>*_lastupdate</code> when a write
occurs (commonly <code>1L</code>; you may use a timestamp like <code>env$curtime</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns <code>NULL</code>. The function works by side effects
(mutating <code>env</code> and its <code>*_lastupdate</code> flags).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Typical use: when <code>accum_backwards = TRUE</code>, wrap the evaluation of a
reaction/input block so you can later accumulate only inputs that were
actually written in that event.</p><ul><li><p>The function creates a private backing store for <code>tracked</code> names and
installs active bindings in <code>env</code>. Reads return the stored value.
Writes (via <code>&lt;-</code> or <code>=</code>) update the store <strong>and</strong> set the corresponding
<code>*_lastupdate</code> flag in <code>env</code>.</p></li>
<li><p>It <strong>does not</strong> zero the <code>*_lastupdate</code> flags; do that before calling
this function (typically once per event).</p></li>
<li><p>Only <strong>top-level symbols</strong> are tracked. To track <code>obj$el &lt;- ...</code>, track
<code>"obj"</code> (the container) rather than <code>"obj$el"</code>.</p></li>
<li><p>Active bindings are removed and plain symbols restored on exit, even if
an error occurs (via <code><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit()</a></code> teardown).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a></h2>


<p>Active bindings add a tiny overhead per read/write of the tracked names
(a function call). Keep <code>tracked</code> small and the binding body minimal.
Install only for the duration of the block and tear down immediately
(handled for you). If your block performs many reads and few writes,
consider a snapshot-and-diff approach instead</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Javier Sanchez Alvarez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

