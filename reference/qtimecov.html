<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Draw Time-to-Event with Time-Dependent Covariates and Luck Adjustment — qtimecov • WARDEN</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Draw Time-to-Event with Time-Dependent Covariates and Luck Adjustment — qtimecov"><meta name="description" content="Simulate a time-to-event (TTE) from a parametric distribution with parameters varying over time.
User provides parameter functions and distribution name. The function uses internal survival and
conditional quantile functions, plus luck adjustment to simulate the event time."><meta property="og:description" content="Simulate a time-to-event (TTE) from a parametric distribution with parameters varying over time.
User provides parameter functions and distribution name. The function uses internal survival and
conditional quantile functions, plus luck adjustment to simulate the event time."><meta property="og:image" content="https://jsanchezalv.github.io/WARDEN/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-ZEDNGW5QRP"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-ZEDNGW5QRP');
</script><!-- Google tag (gtag.js) --></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">WARDEN</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="View Index"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/warden_explained.html">Warden Explained</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd.html">Example in a Sick-Sicker-Dead Model</a></li>
    <li><a class="dropdown-item" href="../articles/inputs_selector.html">How to Use the Automatic Input Selector</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_stream.html">Example in a Sick-Sicker-Dead Model - Random Number Streams &amp; Luck Adjustment</a></li>
    <li><a class="dropdown-item" href="../articles/example_ssd_sobol.html">Example in a Sick-Sicker-Dead Model - Quasi-Random Sobol Sequence vs. Purely Random</a></li>
    <li><a class="dropdown-item" href="../articles/example_eBC.html">Example in Early Breast Cancer</a></li>
    <li><a class="dropdown-item" href="../articles/example_markov.html">Example in a Markov Model</a></li>
    <li><a class="dropdown-item" href="../articles/example_uncertainty.html">Structural and Parametric Uncertainty</a></li>
    <li><a class="dropdown-item" href="../articles/example_ipd.html">Example for Individual Patient Data</a></li>
    <li><a class="dropdown-item" href="../articles/example_colon_degeling.html">Degeling (2025) using WARDEN instead of simmer</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/jsanchezalv/WARDEN" aria-label="View on Github"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Draw Time-to-Event with Time-Dependent Covariates and Luck Adjustment</h1>
      <small class="dont-index">Source: <a href="https://github.com/jsanchezalv/WARDEN/blob/main/R/calculator_f.R" class="external-link"><code>R/calculator_f.R</code></a></small>
      <div class="d-none name"><code>qtimecov.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulate a time-to-event (TTE) from a parametric distribution with parameters varying over time.
User provides parameter functions and distribution name. The function uses internal survival and
conditional quantile functions, plus luck adjustment to simulate the event time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qtimecov</span><span class="op">(</span></span>
<span>  <span class="va">luck</span>,</span>
<span>  <span class="va">a_fun</span>,</span>
<span>  b_fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">dist</span>,</span>
<span>  dt <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  max_time <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  return_luck <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start_time <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-luck">luck<a class="anchor" aria-label="anchor" href="#arg-luck"></a></dt>
<dd><p>Numeric between 0 and 1. Initial random quantile (luck).</p></dd>


<dt id="arg-a-fun">a_fun<a class="anchor" aria-label="anchor" href="#arg-a-fun"></a></dt>
<dd><p>Function of time t returning the first distribution parameter (e.g., rate, shape, meanlog).</p></dd>


<dt id="arg-b-fun">b_fun<a class="anchor" aria-label="anchor" href="#arg-b-fun"></a></dt>
<dd><p>Function of time t returning the second distribution parameter (e.g., scale, sdlog). Defaults to a function returning NA.</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>Character string specifying the distribution. Supported: "exp", "gamma", "lnorm", "norm", "weibull", "llogis", "gompertz".</p></dd>


<dt id="arg-dt">dt<a class="anchor" aria-label="anchor" href="#arg-dt"></a></dt>
<dd><p>Numeric. Time step increment to update parameters and survival. Default 0.1.</p></dd>


<dt id="arg-max-time">max_time<a class="anchor" aria-label="anchor" href="#arg-max-time"></a></dt>
<dd><p>Numeric. Max allowed event time to prevent infinite loops. Default 100.</p></dd>


<dt id="arg-return-luck">return_luck<a class="anchor" aria-label="anchor" href="#arg-return-luck"></a></dt>
<dd><p>Boolean. If TRUE, returns a list with tte and luck (useful if max_time caps TTE)</p></dd>


<dt id="arg-start-time">start_time<a class="anchor" aria-label="anchor" href="#arg-start-time"></a></dt>
<dd><p>Numeric. Time to use as a starting point of reference (e.g., curtime).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Numeric. Simulated time-to-event.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The objective of this function is to avoid the user to have cycle events
with the only scope of updating some variables that depend on time and re-evaluate
a TTE. The idea is that this function should only be called at start and when
an event impacts a variable (e.g., stroke event impacting death TTE), in which case
it would need to be called again at that point. In that case, the user would need to
call e.g., <code>a &lt;- qtimecov</code> with <code>max_time = curtime, return_luck = TRUE</code> arguments,
and then call it again with no max_time, return_luck = FALSE, and
<code>luck = a$luck, start_time=a$tte</code> (so there is no need to add curtime to the resulting time).</p>
<p>It's recommended to play with <code>dt</code> argument to balance running time and precision of the estimates.
For example, if we know we only update the equation annually (not continuously),
then we could just set <code>dt = 1</code>, which would make computations faster.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">param_fun_factory</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p0</span>, <span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">function</span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="va">p0</span> <span class="op">+</span> <span class="va">p1</span><span class="op">*</span><span class="va">.time</span> <span class="op">+</span> <span class="va">p2</span><span class="op">*</span><span class="va">.time</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">p3</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1. Exponential Example</span></span></span>
<span class="r-in"><span><span class="va">rate_exp</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span></span></span>
<span class="r-in"><span>  luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  a_fun <span class="op">=</span> <span class="va">rate_exp</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="st">"exp"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 24.52825</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. Gamma Example</span></span></span>
<span class="r-in"><span><span class="va">shape_gamma</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rate_gamma</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span></span></span>
<span class="r-in"><span>  luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  a_fun <span class="op">=</span> <span class="va">shape_gamma</span>,</span></span>
<span class="r-in"><span>  b_fun <span class="op">=</span> <span class="va">rate_gamma</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="st">"gamma"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 22.22001</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3. Lognormal Example</span></span></span>
<span class="r-in"><span><span class="va">meanlog_lnorm</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span><span class="fl">0.5</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sdlog_lnorm</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span></span></span>
<span class="r-in"><span>  luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  a_fun <span class="op">=</span> <span class="va">meanlog_lnorm</span>,</span></span>
<span class="r-in"><span>  b_fun <span class="op">=</span> <span class="va">sdlog_lnorm</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="st">"lnorm"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 6.555032</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4. Normal Example</span></span></span>
<span class="r-in"><span><span class="va">mean_norm</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sd_norm</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span></span></span>
<span class="r-in"><span>  luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  a_fun <span class="op">=</span> <span class="va">mean_norm</span>,</span></span>
<span class="r-in"><span>  b_fun <span class="op">=</span> <span class="va">sd_norm</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="st">"norm"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11.8122</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 5. Weibull Example</span></span></span>
<span class="r-in"><span><span class="va">shape_weibull</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scale_weibull</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span></span></span>
<span class="r-in"><span>  luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  a_fun <span class="op">=</span> <span class="va">shape_weibull</span>,</span></span>
<span class="r-in"><span>  b_fun <span class="op">=</span> <span class="va">scale_weibull</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="st">"weibull"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.03201</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 6. Loglogistic Example</span></span></span>
<span class="r-in"><span><span class="va">shape_llogis</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scale_llogis</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">7.6</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span></span></span>
<span class="r-in"><span>  luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  a_fun <span class="op">=</span> <span class="va">shape_llogis</span>,</span></span>
<span class="r-in"><span>  b_fun <span class="op">=</span> <span class="va">scale_llogis</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="st">"llogis"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.736007</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 7. Gompertz Example</span></span></span>
<span class="r-in"><span><span class="va">shape_gomp</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rate_gomp</span> <span class="op">&lt;-</span> <span class="fu">param_fun_factory</span><span class="op">(</span><span class="fl">0.091</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span></span></span>
<span class="r-in"><span>  luck <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  a_fun <span class="op">=</span> <span class="va">shape_gomp</span>,</span></span>
<span class="r-in"><span>  b_fun <span class="op">=</span> <span class="va">rate_gomp</span>,</span></span>
<span class="r-in"><span>  dist <span class="op">=</span> <span class="st">"gompertz"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13.57996</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Time varying example, with change at time 8</span></span></span>
<span class="r-in"><span><span class="va">rate_exp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="fl">0.1</span> <span class="op">+</span> <span class="fl">0.01</span><span class="op">*</span><span class="va">.time</span> <span class="op">*</span> <span class="fl">0.00001</span><span class="op">*</span><span class="va">.time</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">rate_exp2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="fl">0.2</span> <span class="op">+</span> <span class="fl">0.02</span><span class="op">*</span><span class="va">.time</span></span></span>
<span class="r-in"><span><span class="va">time_change</span> <span class="op">&lt;-</span> <span class="fl">8</span></span></span>
<span class="r-in"><span><span class="va">init_luck</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">qtimecov</span><span class="op">(</span>luck <span class="op">=</span> <span class="va">init_luck</span>,a_fun <span class="op">=</span> <span class="va">rate_exp</span>,dist <span class="op">=</span> <span class="st">"exp"</span>, dt <span class="op">=</span> <span class="fl">0.005</span>,</span></span>
<span class="r-in"><span>                      max_time <span class="op">=</span> <span class="va">time_change</span>, return_luck <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span>luck <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="va">luck</span>,a_fun <span class="op">=</span> <span class="va">rate_exp2</span>,dist <span class="op">=</span> <span class="st">"exp"</span>, dt <span class="op">=</span> <span class="fl">0.005</span>, start_time<span class="op">=</span><span class="va">a</span><span class="op">$</span><span class="va">tte</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 11.69083</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#An example of how it would work in the model, this would also work with time varying covariates!</span></span></span>
<span class="r-in"><span><span class="va">rate_exp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="fl">0.1</span></span></span>
<span class="r-in"><span><span class="va">rate_exp2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="fl">0.2</span></span></span>
<span class="r-in"><span><span class="va">rate_exp3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">.time</span><span class="op">)</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="va">time_change</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co">#evt 1</span></span></span>
<span class="r-in"><span><span class="va">time_change2</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="co">#evt2</span></span></span>
<span class="r-in"><span><span class="va">init_luck</span> <span class="op">&lt;-</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span><span class="co">#at start, we would just draw TTE</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span>luck <span class="op">=</span> <span class="va">init_luck</span>,a_fun <span class="op">=</span> <span class="va">rate_exp</span>,dist <span class="op">=</span> <span class="st">"exp"</span>, dt <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 29.95232</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#at event in which rate changes (at time 10) we need to do this:</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">qtimecov</span><span class="op">(</span>luck <span class="op">=</span> <span class="va">init_luck</span>,a_fun <span class="op">=</span> <span class="va">rate_exp</span>,dist <span class="op">=</span> <span class="st">"exp"</span>, dt <span class="op">=</span> <span class="fl">0.005</span>,</span></span>
<span class="r-in"><span>                      max_time <span class="op">=</span> <span class="va">time_change</span>, return_luck <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_luck</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="va">luck</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span>luck <span class="op">=</span> <span class="va">new_luck</span>,a_fun <span class="op">=</span> <span class="va">rate_exp2</span>,dist <span class="op">=</span> <span class="st">"exp"</span>, dt <span class="op">=</span> <span class="fl">0.005</span>, start_time<span class="op">=</span><span class="va">a</span><span class="op">$</span><span class="va">tte</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 19.97366</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#at second  event in which rate changes again (at time 15) we need to do this:</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">qtimecov</span><span class="op">(</span>luck <span class="op">=</span> <span class="va">new_luck</span>,a_fun <span class="op">=</span> <span class="va">rate_exp2</span>,dist <span class="op">=</span> <span class="st">"exp"</span>, dt <span class="op">=</span> <span class="fl">0.005</span>,</span></span>
<span class="r-in"><span>                      max_time <span class="op">=</span> <span class="va">time_change2</span>, return_luck <span class="op">=</span> <span class="cn">TRUE</span>, start_time<span class="op">=</span><span class="va">a</span><span class="op">$</span><span class="va">tte</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">new_luck</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="va">luck</span></span></span>
<span class="r-in"><span><span class="co">#final TTE is</span></span></span>
<span class="r-in"><span><span class="fu">qtimecov</span><span class="op">(</span>luck <span class="op">=</span> <span class="va">new_luck</span>,a_fun <span class="op">=</span> <span class="va">rate_exp3</span>,dist <span class="op">=</span> <span class="st">"exp"</span>, dt <span class="op">=</span> <span class="fl">0.005</span>, start_time<span class="op">=</span><span class="va">a</span><span class="op">$</span><span class="va">tte</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18.31411</span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Javier Sanchez Alvarez.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

